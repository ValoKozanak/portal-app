(self.webpackChunkclient_portal_frontend=self.webpackChunkclient_portal_frontend||[]).push([[432],{4111:(e,t,o)=>{"use strict";o.d(t,{A:()=>i});var r=o(9950),s=o(15536),a=o(44414);const i=e=>{let{isOpen:t,onClose:i,file:n}=e;const[l,c]=(0,r.useState)(""),[d,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)("");(0,r.useEffect)(()=>{t&&n&&p()},[t,n]);const p=async()=>{if(n){m(!0),h("");try{const{apiService:e}=await Promise.resolve().then(o.bind(o,50237)),t=await e.downloadFile(n.id),r=window.URL.createObjectURL(t);c(r)}catch(e){h("Nepodarilo sa na\u010d\xedta\u0165 n\xe1h\u013ead s\xfaboru"),console.error("Chyba pri na\u010d\xedtan\xed n\xe1h\u013eadu:",e)}finally{m(!1)}}},x=async()=>{if(n)try{const{apiService:e}=await Promise.resolve().then(o.bind(o,50237)),t=await e.downloadFile(n.id),r=window.URL.createObjectURL(t);window.open(r,"_blank")}catch(e){console.error("Chyba pri otv\xe1ran\xed s\xfaboru:",e),alert("Nepodarilo sa otvori\u0165 s\xfabor")}},g=async()=>{if(n)try{const{apiService:e}=await Promise.resolve().then(o.bind(o,50237)),t=await e.downloadFile(n.id),r=window.URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download=n.original_name,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(r),document.body.removeChild(s)}catch(e){console.error("Chyba pri s\u0165ahovan\xed s\xfaboru:",e),alert("Nepodarilo sa stiahnu\u0165 s\xfabor")}},b=null===n||void 0===n?void 0:n.file_type.includes("image"),y=null===n||void 0===n?void 0:n.file_type.includes("pdf"),v=(null===n||void 0===n?void 0:n.file_type.includes("text"))||(null===n||void 0===n?void 0:n.file_type.includes("document"));return t&&n?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-[95vw] h-[95vh] flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:n.original_name}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:n.file_size>1048576?"".concat((n.file_size/1048576).toFixed(1)," MB"):"".concat((n.file_size/1024).toFixed(1)," KB")})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:x,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",title:"Otvori\u0165 v novom okne",children:"Otvori\u0165"}),(0,a.jsx)("button",{onClick:g,className:"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700",title:"Stiahnu\u0165 s\xfabor",children:"Stiahnu\u0165"}),(0,a.jsx)("button",{onClick:i,className:"p-1 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(s.A,{className:"h-6 w-6"})})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:d?(0,a.jsxs)("div",{className:"flex items-center justify-center h-full",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"Na\u010d\xedtavam n\xe1h\u013ead..."})]}):u?(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-red-500 text-lg mb-2",children:"\u26a0\ufe0f"}),(0,a.jsx)("p",{className:"text-gray-600",children:u}),(0,a.jsxs)("div",{className:"mt-4 space-x-2",children:[(0,a.jsx)("button",{onClick:x,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Otvori\u0165 v novom okne"}),(0,a.jsx)("button",{onClick:g,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Stiahnu\u0165 s\xfabor"})]})]})}):(0,a.jsxs)("div",{className:"h-full overflow-auto",children:[b&&l&&(0,a.jsx)("div",{className:"flex items-center justify-center h-full p-4",children:(0,a.jsx)("img",{src:l,alt:n.original_name,className:"max-w-full max-h-full object-contain"})}),y&&l&&(0,a.jsx)("div",{className:"h-full",children:(0,a.jsx)("iframe",{src:l,className:"w-full h-full border-0",title:n.original_name})}),v&&(0,a.jsx)("div",{className:"h-full p-4",children:(0,a.jsxs)("pre",{className:"whitespace-pre-wrap text-sm text-gray-800 bg-gray-50 p-4 rounded border h-full overflow-auto",children:["Simulovan\xfd textov\xfd s\xfabor: ",n.original_name,"Tento s\xfabor bol vytvoren\xfd v simulovanom prostred\xed. D\xe1tum vytvorenia: ",new Date(n.created_at).toLocaleDateString("sk-SK"),"Ve\u013ekos\u0165: ",n.file_size," bajtov Kateg\xf3ria: ",n.file_type,"Obsah s\xfaboru: Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat."]})}),!b&&!y&&!v&&(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-gray-500 text-lg mb-2",children:"\ud83d\udcc4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"N\xe1h\u013ead nie je dostupn\xfd pre tento typ s\xfaboru"}),(0,a.jsxs)("div",{className:"mt-4 space-x-2",children:[(0,a.jsx)("button",{onClick:x,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Otvori\u0165 v novom okne"}),(0,a.jsx)("button",{onClick:g,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Stiahnu\u0165 s\xfabor"})]})]})})]})})]})}):null}},15340:()=>{},18950:()=>{},20418:(e,t,o)=>{"use strict";o.d(t,{A:()=>l});var r=o(22555),s=o(9950),a=o(52941),i=o(15536),n=o(44414);const l=e=>{let{isOpen:t,onClose:o,onSave:l,task:c,companyEmployees:d,company:m,isAccountant:u=!1,assignedCompanies:h=[],userEmail:p=""}=e;const[x,g]=(0,s.useState)({title:"",description:"",status:"pending",priority:"medium",assignedTo:"",dueDate:"",category:"",estimatedHours:""}),[b,y]=(0,s.useState)(""),[v,f]=(0,s.useState)({}),[j,w]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(t){var e;if(c)g({title:c.title,description:c.description,status:c.status,priority:c.priority,assignedTo:c.assignedTo,dueDate:c.dueDate,category:c.category,estimatedHours:(null===(e=c.estimatedHours)||void 0===e?void 0:e.toString())||""}),c.companyId&&y(c.companyId);else g({title:"",description:"",status:"pending",priority:"medium",assignedTo:"",dueDate:"",category:"",estimatedHours:""}),u&&h.length>0?y(h[0].id):y("");f({})}},[c,t,u]);const k=(e,t)=>{console.log("handleInputChange called:",e,t),g(o=>{const s=(0,r.A)((0,r.A)({},o),{},{[e]:t});return console.log("New formData:",s),s}),f(t=>{if(t[e]){const o=(0,r.A)({},t);return delete o[e],o}return t})};return t?u||m?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:c?"Upravi\u0165 \xfalohu":"Nov\xe1 \xfaloha"}),(0,n.jsx)("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",children:(0,n.jsx)(i.A,{className:"h-6 w-6"})})]}),(0,n.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};if(x.title.trim()||(e.title="N\xe1zov \xfalohy je povinn\xfd"),x.description.trim()||(e.description="Popis \xfalohy je povinn\xfd"),x.assignedTo||(e.assignedTo="Priradenie zamestnanca je povinn\xe9"),x.dueDate){const t=new Date(x.dueDate),o=new Date;o.setHours(0,0,0,0),t<o&&(e.dueDate="Term\xedn nem\xf4\u017ee by\u0165 v minulosti")}else e.dueDate="Term\xedn dokon\u010denia je povinn\xfd";return x.category||(e.category="Kateg\xf3ria je povinn\xe1"),u&&!b&&(e.company="V\xfdber firmy je povinn\xfd"),f(e),0===Object.keys(e).length})()){w(!0);try{const e=u?p:x.assignedTo,t=u?x.assignedTo:x.assignedTo.includes("@")?x.assignedTo.split("@")[0].replace(/[._]/g," ").replace(/\b\w/g,e=>e.toUpperCase()):x.assignedTo;let r,s;if(u&&b){r=b;const e=h.find(e=>e.id===b);s=null===e||void 0===e?void 0:e.name}else m&&(r=m.id,s=m.name);const a={title:x.title.trim(),description:x.description.trim(),status:x.status,priority:x.priority,assignedTo:t,assignedToEmail:e,dueDate:x.dueDate,category:x.category,estimatedHours:x.estimatedHours?parseInt(x.estimatedHours):void 0,createdBy:p||"Aktu\xe1lny pou\u017e\xedvate\u013e",companyId:r,companyName:s};await l(a),o()}catch(t){console.error("Chyba pri ukladan\xed \xfalohy:",t),f({submit:"Nepodarilo sa ulo\u017ei\u0165 \xfalohu"})}finally{w(!1)}}},className:"p-6 space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"N\xe1zov \xfalohy *"}),(0,n.jsx)("input",{type:"text",id:"title",value:x.title,onChange:e=>k("title",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(v.title?"border-red-500":"border-gray-300"),placeholder:"Zadajte n\xe1zov \xfalohy"}),v.title&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:v.title})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Popis \xfalohy *"}),(0,n.jsx)("textarea",{id:"description",value:x.description,onChange:e=>k("description",e.target.value),rows:4,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(v.description?"border-red-500":"border-gray-300"),placeholder:"Podrobn\xfd popis \xfalohy..."}),v.description&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:v.description})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-2",children:"Kateg\xf3ria *"}),(0,n.jsxs)("select",{id:"category",value:x.category,onChange:e=>k("category",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(v.category?"border-red-500":"border-gray-300"),children:[(0,n.jsx)("option",{value:"",children:"Vyberte kateg\xf3riu"}),[{id:"accounting",name:"\xda\u010dtovn\xedctvo"},{id:"tax",name:"Da\u0148ov\xe9 z\xe1le\u017eitosti"},{id:"legal",name:"Pr\xe1vne z\xe1le\u017eitosti"},{id:"hr",name:"Personalistika"},{id:"operations",name:"Oper\xe1cie"},{id:"marketing",name:"Marketing"},{id:"it",name:"IT podpora"},{id:"other",name:"Ostatn\xe9"}].map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))]}),v.category&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:v.category})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-2",children:"Priorita"}),(0,n.jsxs)("select",{id:"priority",value:x.priority,onChange:e=>k("priority",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,n.jsx)("option",{value:"low",children:"N\xedzka"}),(0,n.jsx)("option",{value:"medium",children:"Stredn\xe1"}),(0,n.jsx)("option",{value:"high",children:"Vysok\xe1"}),(0,n.jsx)("option",{value:"urgent",children:"Urgentn\xe1"})]})]})]}),u&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"company",className:"block text-sm font-medium text-gray-700 mb-2",children:"Priradi\u0165 firme *"}),(0,n.jsxs)("select",{id:"company",value:b,onChange:e=>y(e.target.value?parseInt(e.target.value):""),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(v.company?"border-red-500":"border-gray-300"),children:[(0,n.jsx)("option",{value:"",children:"Vyberte firmu"}),h.map(e=>(0,n.jsxs)("option",{value:e.id,children:[e.name," (I\u010cO: ",e.ico,")"]},e.id))]}),v.company&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:v.company})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{htmlFor:"assignedTo",className:"block text-sm font-medium text-gray-700 mb-2",children:[u?"Priradi\u0165 zamestnancovi firmy":"Priradi\u0165 zamestnancovi"," *"]}),(0,n.jsx)("select",{id:"assignedTo",value:x.assignedTo,onChange:e=>k("assignedTo",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(v.assignedTo?"border-red-500":"border-gray-300"),children:u?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("option",{value:"",children:"Vyberte zamestnanca firmy"}),(0,n.jsx)("option",{value:"owner",children:"Vlastn\xedk firmy"}),(0,n.jsx)("option",{value:"manager",children:"Mana\u017e\xe9r"}),(0,n.jsx)("option",{value:"employee",children:"Zamestnanec"}),(0,n.jsx)("option",{value:"accountant",children:"\xda\u010dtovn\xedk"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("option",{value:"",children:"Vyberte \xfa\u010dtovn\xedka"}),m&&m.assignedToAccountants&&m.assignedToAccountants.length>0?m.assignedToAccountants.map((e,t)=>{const o=e.includes("@")?e.split("@")[0].replace(/[._]/g," ").replace(/\b\w/g,e=>e.toUpperCase()):e;return(0,n.jsxs)("option",{value:e,children:[o," - \xda\u010dtovn\xedk (",e,")"]},t)}):(0,n.jsx)("option",{value:"",disabled:!0,children:"\u017diadni priraden\xed \xfa\u010dtovn\xedci"})]})}),v.assignedTo&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:v.assignedTo})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"dueDate",className:"block text-sm font-medium text-gray-700 mb-2",children:"Term\xedn dokon\u010denia *"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:"date",id:"dueDate",value:x.dueDate,onChange:e=>k("dueDate",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(v.dueDate?"border-red-500":"border-gray-300")}),(0,n.jsx)(a.A,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"})]}),v.dueDate&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:v.dueDate})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"estimatedHours",className:"block text-sm font-medium text-gray-700 mb-2",children:"Odhadovan\xe9 hodiny"}),(0,n.jsx)("input",{type:"number",id:"estimatedHours",value:x.estimatedHours,onChange:e=>k("estimatedHours",e.target.value),min:"0",step:"0.5",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Napr\xedklad: 8"})]}),c&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,n.jsxs)("select",{id:"status",value:x.status,onChange:e=>k("status",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,n.jsx)("option",{value:"pending",children:"\u010cakaj\xfaca"}),(0,n.jsx)("option",{value:"in_progress",children:"V spracovan\xed"}),(0,n.jsx)("option",{value:"completed",children:"Dokon\u010den\xe1"}),(0,n.jsx)("option",{value:"cancelled",children:"Zru\u0161en\xe1"})]})]}),v.submit&&(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,n.jsx)("p",{className:"text-sm text-red-600",children:v.submit})}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[(0,n.jsx)("button",{type:"button",onClick:o,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500",children:"Zru\u0161i\u0165"}),(0,n.jsx)("button",{type:"submit",disabled:j,className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 border border-transparent rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:j?"Uklad\xe1m...":c?"Ulo\u017ei\u0165 zmeny":"Vytvori\u0165 \xfalohu"})]})]})]})}):(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Chyba"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"Pre vytvorenie \xfalohy mus\xedte ma\u0165 aspo\u0148 jednu firmu. Najprv vytvorte firmu."}),(0,n.jsx)("button",{onClick:o,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Zavrie\u0165"})]})})}):null}},21638:()=>{},40390:(e,t,o)=>{"use strict";o.d(t,{A:()=>p});var r=o(9950),s=o(22896),a=o(80229),i=o(12340),n=o(21946),l=o(41435),c=o(23615),d=o(50201),m=o(16467),u=o(62551),h=o(44414);const p=e=>{let{companyId:t,userEmail:o,companyEmail:p,isCompanyView:x=!1,onFileSelect:g,userRole:b="company",companyName:y,companyICO:v}=e;const[f,j]=(0,r.useState)(!1),[w,k]=(0,r.useState)(!1),[N,S]=(0,r.useState)(null),[_,D]=(0,r.useState)([]),[A,C]=(0,r.useState)(""),[z,F]=(0,r.useState)(0),[E,I]=(0,r.useState)(!1),[T,P]=(0,r.useState)(null);(0,r.useEffect)(()=>{L()},[]);const L=async()=>{console.log("=== DROPBOX INTEGRATION - checkAuthStatus ==="),console.log("DropboxIntegration.checkAuthStatus - za\u010diatok");const e=u.k.isAuthenticated();if(console.log("DropboxIntegration.checkAuthStatus - authenticated:",e),j(e),e)try{const t=await u.k.getAccountInfo();S(t),R(e)}catch(t){console.error("Error loading account info:",t);try{await u.k.refreshAccessToken();const e=await u.k.getAccountInfo();S(e),R(!0)}catch(o){console.error("Error refreshing token:",o),U()}}},O=()=>{const e=u.k.getAuthUrl();window.location.href=e},U=()=>{u.k.logout(),j(!1),S(null),D([])},R=async e=>{if(void 0!==e?e:f){k(!0);try{if(console.log("=== DROPBOX INTEGRATION DEBUG ==="),x&&v){const e=u.k.getCompanyFolderPath(v),t=await u.k.listFiles(e,v);D(t),C(e)}else{const e=await u.k.listFiles(A,o);D(e)}}catch(t){console.error("DropboxIntegration.loadFiles - ERROR:",t),t instanceof Error&&(console.error("DropboxIntegration.loadFiles - error.message:",t.message),console.error("DropboxIntegration.loadFiles - error.stack:",t.stack))}finally{k(!1)}}},B=e=>{if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]};return f?(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,h.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,h.jsx)(i.A,{className:"h-6 w-6 text-blue-500"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:x&&p?"Dropbox s\xfabory - ".concat(p):o?"Dropbox s\xfabory - ".concat(o):"Dropbox s\xfabory"}),N&&(0,h.jsxs)("p",{className:"text-sm text-gray-600",children:["Prihl\xe1sen\xfd ako: ","company"===b&&y?y:N.name.display_name]})]})]}),(0,h.jsx)("div",{className:"flex items-center space-x-2",children:"company"!==b&&(0,h.jsxs)(h.Fragment,{children:[(o||x&&p)&&(0,h.jsxs)("button",{onClick:async()=>{if(f&&v)try{const e=await u.k.getCompanySharedLink(v);navigator.clipboard.writeText(e),alert("Zdie\u013eate\u013en\xfd link bol skop\xedrovan\xfd do clipboard!")}catch(e){console.error("Error creating shared link:",e),alert("Chyba pri vytv\xe1ran\xed zdie\u013eate\u013en\xe9ho linku")}},className:"inline-flex items-center px-3 py-1 text-sm bg-green-600 text-white rounded-md hover:bg-green-700",title:"Vytvori\u0165 zdie\u013eate\u013en\xfd link",children:[(0,h.jsx)(c.A,{className:"h-4 w-4 mr-1"}),"Zdie\u013ea\u0165"]}),(0,h.jsx)("button",{onClick:U,className:"text-sm text-red-600 hover:text-red-700",children:"Odhl\xe1si\u0165"})]})})]})}),(0,h.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,h.jsx)("input",{type:"file",onChange:e=>{var t;return P((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},className:"flex-1 border border-gray-300 rounded-md px-3 py-2"}),(0,h.jsxs)("button",{onClick:async()=>{if(T&&f){I(!0),F(0);try{const e=x&&v?v:void 0,t=await u.k.uploadFile(T,A||"",e);D(e=>[...e,{id:t.id,name:t.name,path_lower:t.path_lower,size:t.size,server_modified:t.server_modified,content_hash:"",tag:"file"}]),P(null),F(100)}catch(e){console.error("Error uploading file:",e),alert("Chyba pri nahr\xe1van\xed s\xfaboru")}finally{I(!1),F(0)}}},disabled:!T||E,className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,h.jsx)(a.A,{className:"h-5 w-5 mr-2"}),E?"Nahr\xe1vam...":"Nahra\u0165"]})]}),E&&(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,h.jsx)("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(z,"%")}})})})]}),(0,h.jsx)("div",{className:"px-6 py-2 bg-gray-50 border-b border-gray-200",children:(0,h.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,h.jsx)("button",{onClick:()=>{const e=A.split("/").slice(0,-1).join("/");C(e),R()},disabled:!A,className:"text-blue-600 hover:text-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:".."}),(0,h.jsx)("span",{className:"text-gray-600",children:"/"}),(0,h.jsx)("span",{className:"text-gray-900",children:A||"root"})]})}),(0,h.jsx)("div",{className:"p-6",children:w?(0,h.jsxs)("div",{className:"text-center py-8",children:[(0,h.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,h.jsx)("p",{className:"mt-2 text-gray-600",children:"Na\u010d\xedtavam s\xfabory..."})]}):_.length>0?(0,h.jsx)("div",{className:"space-y-2",children:_.map(e=>{const t=(e=>"folder"===e.tag?l.A:e.name.match(/\.(jpg|jpeg|png|gif|bmp|svg)$/i)?d.A:n.A)(e);return(0,h.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-3 flex-1 cursor-pointer",onClick:()=>"folder"===e.tag?(e=>{"folder"===e.tag&&(C(e.path_lower),R())})(e):null===g||void 0===g?void 0:g(e),children:[(0,h.jsx)(t,{className:"h-5 w-5 text-gray-500"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),"file"===e.tag&&(0,h.jsxs)("p",{className:"text-sm text-gray-500",children:[B(e.size)," \u2022 ",new Date(e.server_modified).toLocaleDateString("sk-SK")]})]})]}),"file"===e.tag&&(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)("button",{onClick:()=>(async e=>{if(f)try{const t=await u.k.downloadFile(e.path_lower),o=window.URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=e.name,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(o),document.body.removeChild(r)}catch(t){console.error("Error downloading file:",t),alert("Chyba pri s\u0165ahovan\xed s\xfaboru")}})(e),className:"text-blue-600 hover:text-blue-700 p-1",title:"Stiahnu\u0165",children:(0,h.jsx)(s.A,{className:"h-4 w-4"})}),(0,h.jsx)("button",{onClick:()=>(async e=>{if(f&&window.confirm('Naozaj chcete vymaza\u0165 s\xfabor "'.concat(e.name,'"?')))try{await u.k.deleteFile(e.path_lower),D(t=>t.filter(t=>t.id!==e.id))}catch(t){console.error("Error deleting file:",t),alert("Chyba pri mazan\xed s\xfaboru")}})(e),className:"text-red-600 hover:text-red-700 p-1",title:"Vymaza\u0165",children:(0,h.jsx)(m.A,{className:"h-4 w-4"})})]})]},e.id)})}):(0,h.jsxs)("div",{className:"text-center py-8",children:[(0,h.jsx)(i.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,h.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"\u017diadne s\xfabory"}),(0,h.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:A?"Tento prie\u010dinok je pr\xe1zdny":"Za\u010dnite nahr\xe1van\xedm s\xfaborov"})]})})]}):(0,h.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,h.jsxs)("div",{className:"text-center",children:[(0,h.jsx)(i.A,{className:"mx-auto h-12 w-12 text-blue-500 mb-4"}),(0,h.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Pripojte sa k Dropbox"}),(0,h.jsx)("p",{className:"text-gray-600 mb-4",children:"Synchronizujte s\xfabory s va\u0161\xedm Dropbox \xfa\u010dtom pre bezpe\u010dn\xe9 z\xe1lohovanie a pr\xedstup z ak\xe9hoko\u013evek zariadenia."}),(0,h.jsxs)("button",{onClick:O,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[(0,h.jsx)(i.A,{className:"h-5 w-5 mr-2"}),"Pripoji\u0165 Dropbox"]})]})})}},47790:()=>{},51069:()=>{},62551:(e,t,o)=>{"use strict";o.d(t,{k:()=>n});var r=o(23601);const s="aw4ioyb0u4dbis4",a="ub03kukj9sx6fta",i="http://localhost:3000/dropbox-callback";const n=new class{constructor(){this.dbx=null,this.accessToken=null,console.log("DropboxService: Inicializujem..."),console.log("DropboxService: Environment premenn\xe9:",{appKey:s,appSecret:a?"***":"CH\xddBA",appSecretLength:a?15:0,redirectUri:i}),this.accessToken=localStorage.getItem("dropbox_access_token"),console.log("DropboxService: Token z localStorage:",this.accessToken?"existuje":"neexistuje"),this.accessToken?(this.initializeDropbox(this.accessToken),console.log("DropboxService: Dropbox klient inicializovan\xfd")):console.log("DropboxService: \u017diadny token, Dropbox klient nie je inicializovan\xfd")}initializeDropbox(e){this.dbx=new r.Dropbox({accessToken:e,fetch:window.fetch.bind(window)})}getAuthUrl(){localStorage.removeItem("dropbox_auth_state");const e=Math.random().toString(36).substring(7);localStorage.setItem("dropbox_auth_state",e),console.log("DropboxService.getAuthUrl - konfigur\xe1cia:",{appKey:s,redirectUri:i,state:e,timestamp:(new Date).toISOString()});const t="https://www.dropbox.com/oauth2/authorize?client_id=".concat(s,"&response_type=code&redirect_uri=").concat(encodeURIComponent(i),"&state=").concat(e,"&token_access_type=offline");return console.log("DropboxService.getAuthUrl - vygenerovan\xfd URL:",t),t}async handleAuthCallback(e,t){console.log("dropboxService.handleAuthCallback - za\u010diatok"),console.log("Parametre:",{code:e.substring(0,10)+"...",state:t});const o=localStorage.getItem("dropbox_auth_state");if(console.log("Ulo\u017een\xfd state:",o),console.log("State porovnanie:",{received:t,saved:o,match:t===o}),t!==o)throw console.error("State nezhoduje:",{received:t,saved:o}),console.error("V\u0161etky localStorage polo\u017eky:",{dropbox_auth_state:localStorage.getItem("dropbox_auth_state"),dropbox_access_token:localStorage.getItem("dropbox_access_token"),dropbox_refresh_token:localStorage.getItem("dropbox_refresh_token")}),new Error("Invalid state parameter");console.log("State kontrola \xfaspe\u0161n\xe1, pokra\u010dujem v spracovan\xed...");try{console.log("Posielam po\u017eiadavku na Dropbox API..."),console.log("DropboxService.handleAuthCallback - parametre pre API:",{code:e.substring(0,10)+"...",client_id:s,client_secret:a?"***":"CH\xddBA",redirect_uri:i});const t=new URLSearchParams({code:e,grant_type:"authorization_code",client_id:s,client_secret:a,redirect_uri:i});console.log("DropboxService.handleAuthCallback - request body:",t.toString());const o=await window.fetch("https://api.dropboxapi.com/oauth2/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t});if(console.log("Dropbox API response status:",o.status),!o.ok){const e=await o.text();throw console.error("Dropbox API error:",e),console.error("Dropbox API response headers:",Object.fromEntries(o.headers.entries())),new Error("Failed to exchange code for token: ".concat(e))}const r=await o.json();return console.log("Dropbox API \xfaspe\u0161n\xe1 odpove\u010f:",{access_token:r.access_token.substring(0,10)+"...",token_type:r.token_type,expires_in:r.expires_in}),this.accessToken=r.access_token,localStorage.setItem("dropbox_access_token",r.access_token),r.refresh_token&&localStorage.setItem("dropbox_refresh_token",r.refresh_token),localStorage.removeItem("dropbox_auth_state"),console.log("State vy\u010disten\xfd po \xfaspe\u0161nom spracovan\xed"),console.log("Tokeny ulo\u017een\xe9 do localStorage"),this.initializeDropbox(r.access_token),console.log("Dropbox klient inicializovan\xfd"),r}catch(r){throw console.error("Error during OAuth callback:",r),r}}isAuthenticated(){const e=localStorage.getItem("dropbox_access_token");e&&!this.accessToken&&(this.accessToken=e,this.initializeDropbox(e),console.log("DropboxService.isAuthenticated: Reinicializoval klienta z localStorage"));const t=null!==this.dbx&&null!==this.accessToken;return console.log("DropboxService.isAuthenticated:",{dbx:null!==this.dbx,accessToken:null!==this.accessToken,tokenFromStorage:e?"existuje":"neexistuje",result:t}),t}logout(){this.dbx=null,this.accessToken=null,localStorage.removeItem("dropbox_access_token"),localStorage.removeItem("dropbox_refresh_token"),localStorage.removeItem("dropbox_auth_state")}async getAccountInfo(){if(!this.dbx)throw new Error("Dropbox not initialized");try{if(console.log("DropboxService.getAccountInfo - vol\xe1m Dropbox API..."),!this.dbx.usersGetCurrentAccount)throw new Error("Dropbox client not properly initialized");if(!this.dbx.usersGetCurrentAccount)throw console.error("Dropbox client methods not available"),new Error("Dropbox client methods not available");const e=await this.dbx.usersGetCurrentAccount();return console.log("DropboxService.getAccountInfo - odpove\u010f:",e),e.result}catch(e){if(console.error("Error getting account info:",e),e instanceof Error&&(e.message.includes("fetch")||e.message.includes("Illegal invocation"))){console.log("DropboxService.getAccountInfo - probl\xe9m s fetch, reinicializujem klienta...");const e=localStorage.getItem("dropbox_access_token");if(e){this.initializeDropbox(e);const t=await this.dbx.usersGetCurrentAccount();return console.log("DropboxService.getAccountInfo - reinicializ\xe1cia \xfaspe\u0161n\xe1:",t),t.result}}throw e}}async listFiles(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if(!this.dbx)throw new Error("Dropbox not initialized");try{console.log("=== DROPBOX SERVICE DEBUG ==="),console.log("DropboxService.listFiles - za\u010diatok"),console.log("DropboxService.listFiles - path:",e),console.log("DropboxService.listFiles - ico:",t),console.log("DropboxService.listFiles - this.dbx exists:",!!this.dbx);let o=e;if(t&&!e.startsWith("/Portal/Companies/")){const r=this.getCompanyFolderPath(t);o=r+(e?"/"+e:""),console.log("DropboxService.listFiles - companyFolder:",r)}console.log("DropboxService.listFiles - targetPath:",o),console.log("DropboxService.listFiles - vol\xe1m this.dbx.filesListFolder...");const r=await this.dbx.filesListFolder({path:o,limit:100});console.log("DropboxService.listFiles - response received");return r.result.entries.map(e=>({id:"deleted"===e[".tag"]?"":e.id||"",name:e.name,path_lower:e.path_lower||"",size:"file"===e[".tag"]&&e.size||0,server_modified:"file"===e[".tag"]&&e.server_modified||"",content_hash:"file"===e[".tag"]&&e.content_hash||"",tag:e[".tag"]}))}catch(o){throw console.error("DropboxService.listFiles - ERROR:",o),o instanceof Error&&(console.error("DropboxService.listFiles - error.message:",o.message),console.error("DropboxService.listFiles - error.stack:",o.stack)),o}}getCompanyFolderPath(e){const t=this.hashICO(e);return"/Portal/Companies/".concat(t)}hashICO(e){return e.replace(/\s/g,"").replace(/[^a-zA-Z0-9]/g,"")}async createCompanyFolder(e){if(!this.dbx)throw new Error("Dropbox not initialized");try{const t=this.getCompanyFolderPath(e);await this.dbx.filesCreateFolderV2({path:t,autorename:!1});return t}catch(t){throw console.error("Error creating company folder:",t),t}}async getCompanySharedLink(e){if(!this.dbx)throw new Error("Dropbox not initialized");try{const t=this.getCompanyFolderPath(e);return await this.getSharedLink(t)}catch(t){throw console.error("Error getting company shared link:",t),t}}async uploadFile(e,t,o,r){if(!this.dbx)throw new Error("Dropbox not initialized");try{const r=await e.arrayBuffer();let s=t+"/"+e.name;if(o&&!t.startsWith("/Portal/Companies/")){const r=this.getCompanyFolderPath(o);s=r+"/"+(t?t+"/":"")+e.name,console.log("DropboxService.uploadFile - companyFolder:",r)}console.log("DropboxService.uploadFile - fullPath:",s);const a=await this.dbx.filesUpload({path:s,contents:r,mode:{".tag":"overwrite"},autorename:!0,mute:!1});return console.log("DropboxService.uploadFile - upload response:",a),{id:a.result.id,name:a.result.name,path_lower:a.result.path_lower||"",size:a.result.size,server_modified:a.result.server_modified}}catch(s){throw console.error("Error uploading file:",s),s}}async downloadFile(e){if(!this.dbx)throw new Error("Dropbox not initialized");try{const t=(await this.dbx.filesDownload({path:e})).result.fileBlob;return new Blob([t],{type:t.type||"application/octet-stream"})}catch(t){throw console.error("Error downloading file:",t),t}}async deleteFile(e){if(!this.dbx)throw new Error("Dropbox not initialized");try{await this.dbx.filesDeleteV2({path:e})}catch(t){throw console.error("Error deleting file:",t),t}}async createFolder(e){if(!this.dbx)throw new Error("Dropbox not initialized");try{await this.dbx.filesCreateFolderV2({path:e,autorename:!0})}catch(t){throw console.error("Error creating folder:",t),t}}async getSharedLink(e){if(!this.dbx)throw new Error("Dropbox not initialized");try{return(await this.dbx.sharingCreateSharedLinkWithSettings({path:e,settings:{requested_visibility:{".tag":"public"},audience:{".tag":"public"},access:{".tag":"viewer"}}})).result.url}catch(t){throw console.error("Error creating shared link:",t),t}}async refreshAccessToken(){const e=localStorage.getItem("dropbox_refresh_token");if(!e)throw new Error("No refresh token available");try{const t=await window.fetch("https://api.dropboxapi.com/oauth2/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:e,client_id:s,client_secret:a})});if(!t.ok)throw new Error("Failed to refresh token");const o=await t.json();return this.accessToken=o.access_token,localStorage.setItem("dropbox_access_token",o.access_token),this.initializeDropbox(o.access_token),o.access_token}catch(t){throw console.error("Error refreshing token:",t),t}}async createSharedLink(e,t){if(!this.dbx)throw new Error("Dropbox not initialized");try{console.log("DropboxService.createSharedLink - vytv\xe1ram link pre:",e),console.log("DropboxService.createSharedLink - opr\xe1vnenia:",t);let o={".tag":"viewer"};(t.canEdit||t.canUpload||t.canDelete)&&(o={".tag":"editor"}),console.log("DropboxService.createSharedLink - access level:",o);const r=await this.dbx.sharingCreateSharedLinkWithSettings({path:e,settings:{requested_visibility:{".tag":"public"},audience:{".tag":"public"},access:o}});return console.log("DropboxService.createSharedLink - \xfaspe\u0161ne vytvoren\xfd link:",r.result.url),r.result.url}catch(o){if(console.error("Error creating shared link with permissions:",o),o instanceof Error&&(o.message.includes("shared_link_already_exists")||o.message.includes("409"))){console.log("Link u\u017e existuje (409), z\xedskavam existuj\xfaci link...");try{const t=await this.dbx.sharingListSharedLinks({path:e,direct_only:!1});if(t.result.links.length>0)return console.log("Na\u0161iel som existuj\xfaci link:",t.result.links[0].url),t.result.links[0].url}catch(r){console.error("Chyba pri z\xedskavan\xed existuj\xfaceho linku:",r)}}throw o}}async revokeSharedLink(e){if(!this.dbx)throw new Error("Dropbox not initialized");try{console.log("DropboxService.revokeSharedLink - odvol\xe1vam link:",e),await this.dbx.sharingRevokeSharedLink({url:e}),console.log("DropboxService.revokeSharedLink - link \xfaspe\u0161ne odvolan\xfd")}catch(t){if(console.error("Error revoking shared link:",t),t instanceof Error&&t.message.includes("not_found"))return void console.log("Link u\u017e neexistuje, pova\u017eujem za \xfaspe\u0161ne odvolan\xfd");throw t}}async getAllSharedLinks(){if(!this.dbx)throw new Error("Dropbox not initialized");try{console.log("DropboxService.getAllSharedLinks - z\xedskavam v\u0161etky zdie\u013eate\u013en\xe9 linky...");const e=await this.dbx.sharingListSharedLinks({path:"/Portal/Companies",direct_only:!1});return console.log("DropboxService.getAllSharedLinks - na\u010d\xedtan\xe9 linky:",e.result.links),e.result.links}catch(e){throw console.error("Error getting shared links:",e),e}}async checkFolderExists(e){if(!this.dbx)throw new Error("Dropbox not initialized");try{console.log("DropboxService.checkFolderExists - kontrolujem zlo\u017eku:",e);const t=await this.dbx.filesGetMetadata({path:e});return console.log("DropboxService.checkFolderExists - zlo\u017eka existuje:",t),"folder"===t.result[".tag"]}catch(t){return console.log("DropboxService.checkFolderExists - zlo\u017eka neexistuje:",t),!1}}}},64688:()=>{},66089:()=>{},73776:()=>{},75520:(e,t,o)=>{"use strict";o.d(t,{A:()=>p});var r=o(22555),s=o(9950),a=o(50237),i=o(99632),n=o(81518),l=o(82777),c=o(21946),d=o(50201),m=o(16467),u=o(15536),h=o(44414);const p=e=>{let{isOpen:t,onClose:o,companyId:p,companies:x=[],onFileUpload:g,userRole:b="company"}=e;const[y,v]=(0,s.useState)([]),[f,j]=(0,s.useState)(""),[w,k]=(0,s.useState)(""),[N,S]=(0,s.useState)(""),[_,D]=(0,s.useState)(p||0);(0,s.useEffect)(()=>{"company"===b&&p&&D(p)},[b,p]);const[A,C]=(0,s.useState)(!1),[z,F]=(0,s.useState)({}),[E,I]=(0,s.useState)({}),T=[{id:"documents",name:"Dokumenty",icon:l.A},{id:"invoices",name:"Fakt\xfary",icon:c.A},{id:"contracts",name:"Zmluvy",icon:l.A},{id:"reports",name:"Spr\xe1vy",icon:l.A},{id:"images",name:"Obr\xe1zky",icon:d.A},{id:"archives",name:"Arch\xedvy",icon:i.A},{id:"other",name:"Ostatn\xe9",icon:c.A}],P=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","image/jpeg","image/png","image/gif","application/zip","application/x-rar-compressed"],L=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]};return t?(0,h.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center p-6 border-b",children:[(0,h.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Nahra\u0165 s\xfabory"}),(0,h.jsx)("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",children:(0,h.jsx)(u.A,{className:"h-6 w-6"})})]}),(0,h.jsxs)("div",{className:"p-6 space-y-6",children:["company"!==b&&(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Firma *"}),(0,h.jsxs)("select",{value:_,onChange:e=>D(Number(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0,children:[(0,h.jsx)("option",{value:"",children:"Vyberte firmu"}),x.map(e=>(0,h.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),"company"===b&&p&&(0,h.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:(0,h.jsx)("p",{className:"text-sm text-blue-800",children:(0,h.jsx)("strong",{children:"S\xfabory sa nahr\xe1vaj\xfa pre va\u0161u firmu"})})}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Typ s\xfaboru *"}),(0,h.jsxs)("select",{value:f,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0,children:[(0,h.jsx)("option",{value:"",children:"Vyberte typ s\xfaboru"}),T.map(e=>(0,h.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,h.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,h.jsx)(n.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,h.jsxs)("div",{className:"mt-4",children:[(0,h.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[(0,h.jsx)("span",{className:"text-primary-600 hover:text-primary-700 font-medium",children:"Kliknite pre v\xfdber s\xfaborov"}),(0,h.jsx)("span",{className:"text-gray-500",children:" alebo ich sem presu\u0148te"})]}),(0,h.jsx)("input",{id:"file-upload",type:"file",multiple:!0,onChange:e=>{if(e.target.files){const t=Array.from(e.target.files).filter(e=>e.size>10485760?(I(t=>(0,r.A)((0,r.A)({},t),{},{[e.name]:"S\xfabor je pr\xedli\u0161 ve\u013ek\xfd (max. 10MB)"})),!1):!!P.includes(e.type)||(I(t=>(0,r.A)((0,r.A)({},t),{},{[e.name]:"Nepodporovan\xfd typ s\xfaboru"})),!1));v(e=>[...e,...t])}},className:"hidden",accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.zip,.rar"})]}),(0,h.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"PDF, DOC, XLS, obr\xe1zky, arch\xedvy (max. 10MB na s\xfabor)"})]}),y.length>0&&(0,h.jsxs)("div",{children:[(0,h.jsxs)("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:["Vybran\xe9 s\xfabory (",y.length,")"]}),(0,h.jsx)("div",{className:"space-y-2",children:y.map((e,t)=>{const o=(s=e.type).startsWith("image/")?d.A:s.includes("pdf")?l.A:s.includes("zip")||s.includes("rar")?i.A:c.A;var s;const a=z[e.name],n=E[e.name];return(0,h.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-md",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,h.jsx)(o,{className:"h-5 w-5 text-gray-400"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,h.jsx)("p",{className:"text-xs text-gray-500",children:L(e.size)}),n&&(0,h.jsx)("p",{className:"text-xs text-red-600",children:n}),a&&(0,h.jsxs)("div",{className:"mt-1",children:[(0,h.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,h.jsx)("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(a.percentage,"%")}})}),(0,h.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[a.percentage,"% (",L(a.loaded)," / ",L(a.total),")"]})]})]})]}),(0,h.jsx)("button",{onClick:()=>(e=>{const t=y[e];v(t=>t.filter((t,o)=>o!==e)),I(e=>{const o=(0,r.A)({},e);return delete o[t.name],o}),F(e=>{const o=(0,r.A)({},e);return delete o[t.name],o})})(t),className:"text-red-500 hover:text-red-700",children:(0,h.jsx)(m.A,{className:"h-4 w-4"})})]},t)})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Popis (volite\u013en\xe9)"}),(0,h.jsx)("textarea",{value:w,onChange:e=>k(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Kr\xe1tky popis s\xfaborov..."})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tagy (volite\u013en\xe9)"}),(0,h.jsx)("input",{type:"text",value:N,onChange:e=>S(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"d\xf4le\u017eit\xe9, urgent, 2024 (oddelen\xe9 \u010diarkami)"})]}),(0,h.jsxs)("div",{className:"flex space-x-3",children:[(0,h.jsx)("button",{type:"button",onClick:o,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Zru\u0161i\u0165"}),(0,h.jsx)("button",{onClick:async()=>{if(0!==y.length)if(_)if(f){C(!0),I({});try{for(const t of y){F(e=>(0,r.A)((0,r.A)({},e),{},{[t.name]:{loaded:0,total:t.size,percentage:0}}));try{const e=await a.apiService.uploadFile(t,_,"user@portal.sk",f);g(e)}catch(e){I(o=>(0,r.A)((0,r.A)({},o),{},{[t.name]:e instanceof Error?e.message:"Nezn\xe1ma chyba"}))}}}finally{C(!1),v([]),k(""),S(""),F({})}}else alert("Vyberte typ s\xfaboru");else alert("Vyberte firmu, pre ktor\xfa nahr\xe1vate s\xfabory");else alert("Vyberte aspo\u0148 jeden s\xfabor na nahranie")},disabled:0===y.length||A||!_,className:"flex-1 bg-primary-600 text-white py-2 px-4 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:A?"Nahr\xe1vam...":"Nahra\u0165 ".concat(y.length," s\xfaborov")})]})]})]})}):null}},77965:()=>{},78982:()=>{},79368:()=>{},79838:()=>{},92668:()=>{}}]);