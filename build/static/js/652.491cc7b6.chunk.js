"use strict";(self.webpackChunkclient_portal_frontend=self.webpackChunkclient_portal_frontend||[]).push([[652],{10329:(e,t,a)=>{a.d(t,{A:()=>m});var r=a(22555),s=a(9950),d=a(15536),n=a(92605),l=a(15909),i=a(52941),c=a(2391),o=a(99696),x=a(44414);const g=e=>{let{value:t,onChange:a,min:r,max:d,placeholder:n="Vyberte d\xe1tum",className:g="",disabled:u=!1}=e;const[m,h]=(0,s.useState)(!1),[y,p]=(0,s.useState)(new Date),[b,k]=(0,s.useState)([]),[v,w]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{w(!0);try{const e=y.getFullYear(),t=await l.I.getWorkCalendar(e);k(t.holidays)}catch(e){console.error("Chyba pri na\u010d\xedtan\xed sviatkov:",e),k([])}finally{w(!1)}})()},[y.getFullYear()]);const j=e=>{p(t=>{const a=new Date(t);return"prev"===e?a.setMonth(a.getMonth()-1):a.setMonth(a.getMonth()+1),a})},f=(()=>{const e=y.getFullYear(),a=y.getMonth(),s=new Date(e,a,1);new Date(e,a+1,0);let n=s.getDay();0===n&&(n=7),n-=1;const i=new Date(s);i.setDate(i.getDate()-n);const c=[],o=new Date(i);for(let x=0;x<42;x++){const e=l.I.getDayInfo(o,b);c.push({date:new Date(o),isCurrentMonth:o.getMonth()===a,isToday:o.toDateString()===(new Date).toDateString(),isSelected:t==="".concat(o.getFullYear(),"-").concat(String(o.getMonth()+1).padStart(2,"0"),"-").concat(String(o.getDate()).padStart(2,"0")),isWeekend:e.isWeekend,isHoliday:e.isHoliday,holidayName:e.holidayName||void 0,isDisabled:Boolean(r&&o<new Date(r)||d&&o>new Date(d))}),o.setDate(o.getDate()+1)}return c})();return(0,x.jsxs)("div",{className:"relative ".concat(g),children:[(0,x.jsxs)("div",{className:"relative",children:[(0,x.jsx)("input",{type:"text",value:t?new Date(t).toLocaleDateString("sk-SK"):"",placeholder:n,readOnly:!0,disabled:u,onClick:()=>!u&&h(!m),className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-dark-700 text-gray-900 dark:text-white cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"}),(0,x.jsx)(i.A,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"})]}),m&&(0,x.jsxs)("div",{className:"absolute top-full left-0 mt-1 bg-white dark:bg-dark-800 border border-gray-300 dark:border-dark-600 rounded-md shadow-lg z-50 min-w-[280px]",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 dark:border-dark-600",children:[(0,x.jsx)("button",{onClick:()=>j("prev"),className:"p-1 hover:bg-gray-100 dark:hover:bg-dark-700 rounded",children:(0,x.jsx)(c.A,{className:"h-5 w-5"})}),(0,x.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:y.toLocaleDateString("sk-SK",{month:"long",year:"numeric"})}),(0,x.jsx)("button",{onClick:()=>j("next"),className:"p-1 hover:bg-gray-100 dark:hover:bg-dark-700 rounded",children:(0,x.jsx)(o.A,{className:"h-5 w-5"})})]}),(0,x.jsx)("div",{className:"grid grid-cols-7 gap-px bg-gray-200 dark:bg-dark-600",children:["Po","Ut","St","\u0160t","Pi","So","Ne"].map(e=>(0,x.jsx)("div",{className:"bg-white dark:bg-dark-800 p-2 text-center text-xs font-medium text-gray-500 dark:text-gray-400",children:e},e))}),(0,x.jsx)("div",{className:"grid grid-cols-7 gap-px bg-gray-200 dark:bg-dark-600",children:f.map((e,t)=>{let r="bg-white dark:bg-dark-800",s="text-gray-900 dark:text-white",d="";return e.isSelected?(r="bg-blue-500",s="text-white"):e.isToday&&(d="border-2 border-blue-500"),e.isWeekend?(r=e.isSelected?"bg-green-500":"bg-green-50 dark:bg-green-900/20",s=e.isSelected?"text-white":"text-green-700 dark:text-green-300"):e.isHoliday&&(r=e.isSelected?"bg-red-500":"bg-red-50 dark:bg-red-900/20",s=e.isSelected?"text-white":"text-red-700 dark:text-red-300"),e.isDisabled&&(r="bg-gray-100 dark:bg-dark-700",s="text-gray-400 dark:text-gray-500"),(0,x.jsx)("button",{onClick:()=>!e.isDisabled&&(e=>{const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),d="".concat(t,"-").concat(r,"-").concat(s);a(d),h(!1)})(e.date),disabled:e.isDisabled,className:"\n                    ".concat(r," ").concat(s," ").concat(d,"\n                    p-2 text-sm font-medium hover:bg-gray-100 dark:hover:bg-dark-700\n                    disabled:cursor-not-allowed disabled:opacity-50\n                    ").concat(e.isCurrentMonth?"":"opacity-30","\n                    relative\n                  "),title:e.holidayName?"Sviatok: ".concat(e.holidayName):e.isWeekend?"V\xedkend":void 0,children:e.date.getDate()},t)})}),(0,x.jsx)("div",{className:"p-3 border-t border-gray-200 dark:border-dark-600 bg-gray-50 dark:bg-dark-700",children:(0,x.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600 dark:text-gray-400",children:[(0,x.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,x.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,x.jsx)("div",{className:"w-3 h-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700"}),(0,x.jsx)("span",{children:"Sviatky"})]}),(0,x.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,x.jsx)("div",{className:"w-3 h-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700"}),(0,x.jsx)("span",{children:"V\xedkendy"})]})]}),v&&(0,x.jsx)("div",{className:"text-blue-600 dark:text-blue-400",children:"Na\u010d\xedtavam..."})]})})]}),m&&(0,x.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>h(!1)})]})},u=e=>{const t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(r)},m=e=>{let{isOpen:t,onClose:a,leaveRequest:i,companyId:c,employeeId:o,employeeName:m,onSuccess:h}=e;const[y,p]=(0,s.useState)({leave_type:"vacation",start_date:"",end_date:"",total_days:"",reason:""}),[b,k]=(0,s.useState)(!1),v=!!i;(0,s.useEffect)(()=>{t&&p(i?{leave_type:i.leave_type,start_date:i.start_date,end_date:i.end_date,total_days:i.total_days.toString(),reason:i.reason||""}:{leave_type:"vacation",start_date:"",end_date:"",total_days:"",reason:""})},[t,i]);const w=async(e,t)=>{p(a=>{const s=(0,r.A)((0,r.A)({},a),{},{[e]:t});return s.start_date&&s.end_date&&(async(e,t)=>{try{return await l.I.calculateWorkingDays(e,t)}catch(a){return console.error("\u274c Chyba pri v\xfdpo\u010dte pracovn\xfdch dn\xed:",a),l.I.calculateBasicWorkingDays(e,t)}})(s.start_date,s.end_date).then(e=>{p(t=>(0,r.A)((0,r.A)({},t),{},{total_days:e.toString()}))}),s})},j=e=>{const{name:t,value:a}=e.target;"start_date"===t||"end_date"===t?w(t,a):p(e=>(0,r.A)((0,r.A)({},e),{},{[t]:a}))};return t?(0,x.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,x.jsxs)("div",{className:"bg-white dark:bg-dark-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-dark-600",children:[(0,x.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:v?"Upravi\u0165 \u017eiados\u0165 o dovolenku":"Nov\xe1 \u017eiados\u0165 o dovolenku"}),(0,x.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,x.jsx)(d.A,{className:"w-6 h-6"})})]}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),k(!0);try{const e={employee_id:o,company_id:c,leave_type:y.leave_type,start_date:y.start_date,end_date:y.end_date,total_days:parseInt(y.total_days),status:"pending",reason:y.reason||void 0};v?alert("Edit\xe1cia dovoleniek zatia\u013e nie je implementovan\xe1"):await n.hrService.addLeaveRequest(e),h(),a()}catch(t){console.error("Chyba pri ukladan\xed \u017eiadosti o dovolenku:",t),alert("Chyba pri ukladan\xed \u017eiadosti o dovolenku")}finally{k(!1)}},className:"p-6 space-y-6",children:[(0,x.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-dark-700 rounded-lg",children:[(0,x.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Zamestnanec"}),(0,x.jsx)("p",{className:"text-gray-900 dark:text-white",children:m})]}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Typ dovolenky *"}),(0,x.jsxs)("select",{name:"leave_type",value:y.leave_type,onChange:j,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-dark-700 text-gray-900 dark:text-white",children:[(0,x.jsx)("option",{value:"vacation",children:"Dovolenka"}),(0,x.jsx)("option",{value:"sick_leave",children:"PN"}),(0,x.jsx)("option",{value:"personal_leave",children:"Osobn\xe9 vo\u013eno"}),(0,x.jsx)("option",{value:"maternity_leave",children:"Matersk\xe1 dovolenka"}),(0,x.jsx)("option",{value:"paternity_leave",children:"Otcovsk\xe1 dovolenka"}),(0,x.jsx)("option",{value:"unpaid_leave",children:"Neplaten\xe9 vo\u013eno"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Po\u010det dn\xed *"}),(0,x.jsx)("input",{type:"number",name:"total_days",value:y.total_days,onChange:j,min:"1",required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-dark-700 text-gray-900 dark:text-white",placeholder:"5"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Za\u010diatok dovolenky *"}),(0,x.jsx)(g,{value:y.start_date,onChange:e=>w("start_date",e),min:u(new Date),placeholder:"Vyberte d\xe1tum za\u010diatku",className:"w-full"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Koniec dovolenky *"}),(0,x.jsx)(g,{value:y.end_date,onChange:e=>w("end_date",e),min:y.start_date||u(new Date),placeholder:"Vyberte d\xe1tum konca",className:"w-full"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"D\xf4vod"}),(0,x.jsx)("textarea",{name:"reason",value:y.reason,onChange:j,rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-dark-700 text-gray-900 dark:text-white",placeholder:"Pop\xed\u0161te d\xf4vod \u017eiadosti o dovolenku..."})]}),y.start_date&&y.end_date&&(0,x.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,x.jsx)("h4",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-2",children:"Inform\xe1cie o dovolenke"}),(0,x.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-blue-700 dark:text-blue-300",children:"Od:"}),(0,x.jsx)("span",{className:"ml-2 text-blue-900 dark:text-blue-100",children:new Date(y.start_date).toLocaleDateString("sk-SK")})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-blue-700 dark:text-blue-300",children:"Do:"}),(0,x.jsx)("span",{className:"ml-2 text-blue-900 dark:text-blue-100",children:new Date(y.end_date).toLocaleDateString("sk-SK")})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-blue-700 dark:text-blue-300",children:"Po\u010det dn\xed:"}),(0,x.jsxs)("span",{className:"ml-2 text-blue-900 dark:text-blue-100",children:[y.total_days," dn\xed"]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-blue-700 dark:text-blue-300",children:"Typ:"}),(0,x.jsx)("span",{className:"ml-2 text-blue-900 dark:text-blue-100",children:n.hrService.getLeaveTypeLabel(y.leave_type)})]})]})]}),(0,x.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200 dark:border-dark-600",children:[(0,x.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-dark-700 rounded-md hover:bg-gray-200 dark:hover:bg-dark-600 transition-colors",children:"Zru\u0161i\u0165"}),(0,x.jsx)("button",{type:"submit",disabled:b,className:"px-4 py-2 bg-blue-600 dark:bg-blue-500 text-white rounded-md hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors disabled:opacity-50",children:b?"Uklad\xe1m...":v?"Upravi\u0165":"Odosla\u0165 \u017eiados\u0165"})]})]})]})}):null}},15909:(e,t,a)=>{a.d(t,{I:()=>s});var r=a(50237);class s{static async getWorkCalendar(e){return r.apiService.get("/hr/work-calendar/".concat(e))}static isWeekend(e){const t=e.getDay();return 0===t||6===t}static isHoliday(e,t){const a=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),d="".concat(a,"-").concat(r,"-").concat(s);return t.some(e=>e.date===d)}static async calculateWorkingDays(e,t){try{const a=new Date(e),r=new Date(t),s=a.getFullYear(),d=await this.getWorkCalendar(s);let n=0;const l=new Date(a);for(;l<=r;)this.isWeekend(l)||this.isHoliday(l,d.holidays)||n++,l.setDate(l.getDate()+1);return n}catch(a){return console.error("\u274c Chyba pri v\xfdpo\u010dte pracovn\xfdch dn\xed:",a),this.calculateBasicWorkingDays(e,t)}}static calculateBasicWorkingDays(e,t){if(!e||!t)return 0;const a=new Date(e),r=new Date(t);let s=0;const d=new Date(a);for(;d<=r;)this.isWeekend(d)||s++,d.setDate(d.getDate()+1);return s}static getHolidayName(e,t){const a=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),d="".concat(a,"-").concat(r,"-").concat(s),n=t.find(e=>e.date===d);return n?n.title:null}static getHolidaysInRange(e,t,a){const r=new Date(e),s=new Date(t);return a.filter(e=>{const t=new Date(e.date);return t>=r&&t<=s})}static formatDate(e){return e.toLocaleDateString("sk-SK",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}static getDayInfo(e,t){const a=this.isWeekend(e),r=this.isHoliday(e,t);return{isWorkingDay:!a&&!r,isWeekend:a,isHoliday:r,holidayName:r?this.getHolidayName(e,t):void 0}}}},59318:(e,t,a)=>{a.d(t,{A:()=>x});var r=a(22555),s=a(9950),d=a(52941),n=a(11818),l=a(36923),i=a(92605),c=a(15909),o=a(44414);const x=e=>{let{companyId:t,employeeId:a,employeeName:x,isCompanyView:g=!1}=e;const[u,m]=(0,s.useState)("month"),[h,y]=(0,s.useState)(""),[p,b]=(0,s.useState)(""),[k,v]=(0,s.useState)([]),[w,j]=(0,s.useState)(!1),[f,N]=(0,s.useState)([]),[_,D]=(0,s.useState)(null),[S,C]=(0,s.useState)(!1),[A,M]=(0,s.useState)([]),[z,W]=(0,s.useState)(!1),[P,I]=(0,s.useState)(null),F="undefined"!==typeof window?window.localStorage.getItem("userRole"):null,H=(()=>{try{return F?JSON.parse(F):null}catch(e){return F}})(),Y="admin"===H||"accountant"===H||"user"===H;(0,s.useEffect)(()=>{g&&E(),T()},[u,g]),(0,s.useEffect)(()=>{(async()=>{try{if(!h)return;const e=new Date(h).getFullYear(),t=await c.I.getWorkCalendar(e);M(t.holidays||[])}catch(e){M([])}})()},[h]),(0,s.useEffect)(()=>{h&&p&&O()},[h,p,_,S]);const E=async()=>{try{const e=await i.hrService.getEmployees(t);N(e),e.length>0&&D(e[0].id)}catch(e){console.error("Chyba pri na\u010d\xedtan\xed zamestnancov:",e)}},L=()=>{if(!h||!p)return[];const e=new Map;k.forEach(t=>{e.set(t.date,t)});return((e,t)=>{const a=[],r=new Date(e),s=new Date(t),d=new Date(r);for(;d<=s;){const e=d.getFullYear(),t=String(d.getMonth()+1).padStart(2,"0"),r=String(d.getDate()).padStart(2,"0");a.push("".concat(e,"-").concat(t,"-").concat(r)),d.setDate(d.getDate()+1)}return a})(h,p).map(r=>{const s=e.get(r);if(s)return s;const d=(e=>A.some(t=>t.date===e))(r)||(e=>{const t=new Date(e).getDay();return 0===t||6===t})(r)?"holiday":"absent";return{id:-1,employee_id:a||_||0,company_id:t,date:r,check_in:void 0,check_out:void 0,total_hours:void 0,break_minutes:0,status:d,notes:"holiday"===d?"Pracovn\xfd pokoj":void 0,first_name:"",last_name:"",employee_id_code:"",created_at:"",updated_at:"",synthetic:!0}})},T=()=>{const e=new Date;let t,a;switch(u){case"week":t=new Date(e),t.setDate(e.getDate()-e.getDay()+1),a=new Date(e);break;case"month":default:t=new Date(e.getFullYear(),e.getMonth(),1),a=new Date(e.getFullYear(),e.getMonth()+1,0);break;case"year":t=new Date(e.getFullYear(),0,1),a=new Date(e.getFullYear(),11,31);break;case"custom":return}const r=e=>{const t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(r)};y(r(t)),b(r(a))},O=async()=>{if(h&&p){j(!0);try{if(S){const e=(await Promise.all(f.map(async e=>{try{return(await i.hrService.getAttendance(t,e.id,h,p)).map(t=>(0,r.A)((0,r.A)({},t),{},{employee_name:"".concat(e.first_name," ").concat(e.last_name)}))}catch(a){return console.error("Chyba pri na\u010d\xedtan\xed doch\xe1dzky pre zamestnanca ".concat(e.id,":"),a),[]}}))).flat();v(e)}else{const r=a||_;if(!r)return;try{const e=await i.hrService.checkAttendanceDuplicates(t,r,h,p);e.duplicates&&e.duplicates.length>0&&console.warn("N\xe1jden\xe9 duplicitn\xe9 z\xe1znamy doch\xe1dzky:",e.duplicates)}catch(e){console.error("Chyba pri kontrole duplicitn\xfdch z\xe1znamov:",e)}const s=await i.hrService.getAttendance(t,r,h,p);v(s)}}catch(e){console.error("Chyba pri na\u010d\xedtan\xed doch\xe1dzky:",e)}finally{j(!1)}}},K=e=>{if(!e)return"-";try{if(e.match(/^\d{2}:\d{2}$/))return e;const t=new Date(e);return isNaN(t.getTime())?"-":t.toLocaleTimeString("sk-SK",{hour:"2-digit",minute:"2-digit",hour12:!1})}catch(t){return console.error("Chyba pri form\xe1tovan\xed \u010dasu:",e,t),"-"}},[V,q]=(0,s.useState)(null);return(0,s.useEffect)(()=>{const e=async()=>{const e=await(async()=>{if(!k.length)return null;let e,t,a,r;if(S){e=await c.I.calculateWorkingDays(h,p);const s=k.filter(e=>"absent"===e.status).length;t=s,a=e-s,r=k.filter(e=>"late"===e.status).length}else{e=await c.I.calculateWorkingDays(h,p);const s=new Set(k.filter(e=>"present"===e.status).map(e=>e.date)),d=new Set(k.filter(e=>"late"===e.status).map(e=>e.date)),n=new Set;s.forEach(e=>n.add(e)),d.forEach(e=>n.add(e)),t=n.size,a=Math.max(0,e-t),r=d.size}const s=k.reduce((e,t)=>e+(t.total_hours||0),0),d=k.reduce((e,t)=>e+(t.break_minutes||0),0),n=e>0?s/e:0,l=e>0?Math.min(100,t/e*100):0;return console.log("Attendance Overview Debug:",{attendanceLength:k.length,totalHours:s,totalBreakMinutes:d,presentDays:t,absentDays:a,totalDays:e,attendanceRate:l,averageHours:n,uniqueDates:S?"N/A":new Set(k.map(e=>e.date)).size,presentDates:S?"N/A":new Set(k.filter(e=>"present"===e.status).map(e=>e.date)).size,lateDates:S?"N/A":new Set(k.filter(e=>"late"===e.status).map(e=>e.date)).size}),{totalDays:e,presentDays:t,absentDays:a,lateDays:r,totalHours:s,totalBreakMinutes:d,averageHours:n,attendanceRate:l,uniqueEmployees:S?new Set(k.map(e=>e.employee_name)).size:1}})();q(e)};k.length>0?e():q(null)},[k,S,h,p,f.length]),(0,o.jsxs)("div",{className:"bg-white dark:bg-dark-800 rounded-lg shadow p-6",children:[(0,o.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Preh\u013ead doch\xe1dzky"}),x&&(0,o.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:x})]}),(0,o.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 mt-4 lg:mt-0",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)(d.A,{className:"w-5 h-5 text-gray-400"}),(0,o.jsx)("select",{value:u,onChange:e=>m(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-dark-700 text-gray-900 dark:text-white text-sm",children:[{value:"week",label:"Tento t\xfd\u017ede\u0148"},{value:"month",label:"Tento mesiac"},{value:"year",label:"Tento rok"},{value:"custom",label:"Vlastn\xe9 obdobie"}].map(e=>(0,o.jsx)("option",{value:e.value,children:e.label},e.value))})]}),"custom"===u&&(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)("input",{type:"date",value:h,onChange:e=>y(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-dark-700 text-gray-900 dark:text-white text-sm"}),(0,o.jsx)("span",{className:"text-gray-500",children:"-"}),(0,o.jsx)("input",{type:"date",value:p,onChange:e=>b(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-dark-700 text-gray-900 dark:text-white text-sm"})]})]})]}),g&&f.length>0&&(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Zobrazenie doch\xe1dzky"}),(0,o.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,o.jsxs)("label",{className:"flex items-center",children:[(0,o.jsx)("input",{type:"radio",name:"viewType",checked:!S,onChange:()=>C(!1),className:"mr-2"}),(0,o.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Individu\xe1lne"})]}),(0,o.jsxs)("label",{className:"flex items-center",children:[(0,o.jsx)("input",{type:"radio",name:"viewType",checked:S,onChange:()=>C(!0),className:"mr-2"}),(0,o.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"V\u0161etci zamestnanci"})]})]})]}),!S&&(0,o.jsx)("select",{value:_||"",onChange:e=>D(Number(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-dark-700 text-gray-900 dark:text-white",children:f.map(e=>(0,o.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name]},e.id))})]}),V&&(0,o.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 ".concat(S?"lg:grid-cols-5":""," gap-4 mb-6"),children:[(0,o.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(n.A,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),(0,o.jsxs)("div",{className:"ml-3",children:[(0,o.jsx)("p",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:"\xda\u010das\u0165"}),(0,o.jsxs)("p",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:[V.attendanceRate.toFixed(1),"%"]})]})]})}),(0,o.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(l.A,{className:"w-8 h-8 text-green-600 dark:text-green-400"}),(0,o.jsxs)("div",{className:"ml-3",children:[(0,o.jsx)("p",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:"Celkov\xe9 hodiny"}),(0,o.jsx)("p",{className:"text-2xl font-bold text-green-900 dark:text-green-100",children:(()=>{const e=V.totalHours,t=Math.floor(e),a=Math.round(60*(e-t));return"".concat(t,":").concat(a.toString().padStart(2,"0"))})()})]})]})}),(0,o.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(l.A,{className:"w-8 h-8 text-yellow-600 dark:text-yellow-400"}),(0,o.jsxs)("div",{className:"ml-3",children:[(0,o.jsx)("p",{className:"text-sm font-medium text-yellow-600 dark:text-yellow-400",children:"Priemern\xe9 hodiny"}),(0,o.jsx)("p",{className:"text-2xl font-bold text-yellow-900 dark:text-yellow-100",children:(()=>{const e=V.averageHours,t=Math.floor(e),a=Math.round(60*(e-t));return"".concat(t,":").concat(a.toString().padStart(2,"0"))})()})]})]})}),(0,o.jsx)("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(l.A,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"}),(0,o.jsxs)("div",{className:"ml-3",children:[(0,o.jsx)("p",{className:"text-sm font-medium text-purple-600 dark:text-purple-400",children:"Prest\xe1vky"}),(0,o.jsx)("p",{className:"text-2xl font-bold text-purple-900 dark:text-purple-100",children:(()=>{const e=Math.round(V.totalBreakMinutes),t=Math.floor(e/60),a=e%60;return"".concat(t,":").concat(a.toString().padStart(2,"0"))})()})]})]})}),S&&(0,o.jsx)("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-lg",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(n.A,{className:"w-8 h-8 text-indigo-600 dark:text-indigo-400"}),(0,o.jsxs)("div",{className:"ml-3",children:[(0,o.jsx)("p",{className:"text-sm font-medium text-indigo-600 dark:text-indigo-400",children:"Zamestnanci"}),(0,o.jsx)("p",{className:"text-2xl font-bold text-indigo-900 dark:text-indigo-100",children:V.uniqueEmployees})]})]})})]}),V&&(0,o.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,o.jsxs)("div",{className:"text-center p-3 bg-gray-50 dark:bg-dark-700 rounded-lg",children:[(0,o.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:V.totalDays}),(0,o.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:S?"Celkovo pracovn\xfdch dn\xed":"Celkovo dn\xed"})]}),(0,o.jsxs)("div",{className:"text-center p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,o.jsx)("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:V.presentDays}),(0,o.jsx)("p",{className:"text-sm text-green-600 dark:text-green-400",children:S?"Dni pracovn\xe9ho vo\u013ena":"Pr\xedtomn\xe9 dni"})]}),(0,o.jsxs)("div",{className:"text-center p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[(0,o.jsx)("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:V.absentDays}),(0,o.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:S?"Pr\xedtomn\xe9 dni":"Nepr\xedtomn\xe9 dni"})]}),(0,o.jsxs)("div",{className:"text-center p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[(0,o.jsx)("p",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:V.lateDays}),(0,o.jsx)("p",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"Me\u0161kania"})]})]}),(0,o.jsx)("div",{className:"overflow-x-auto",children:(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-dark-600",children:[(0,o.jsx)("thead",{className:"bg-gray-50 dark:bg-dark-700",children:(0,o.jsxs)("tr",{children:[S&&(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Zamestnanec"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"D\xe1tum"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Pr\xedchod"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Odchod"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Hodiny"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Prest\xe1vky"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),!S&&Y&&(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Akcie"})]})}),(0,o.jsx)("tbody",{className:"bg-white dark:bg-dark-800 divide-y divide-gray-200 dark:divide-dark-600",children:w?(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:S||Y?7:6,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"Na\u010d\xedtavam..."})}):!S&&0===L().length||S&&0===k.length?(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:S||Y?7:6,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"\u017diadne z\xe1znamy doch\xe1dzky pre vybran\xe9 obdobie"})}):(S?k:L()).map(e=>{return(0,o.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-dark-700",children:[S&&(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:e.employee_name||"-"}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:(t=e.date,new Date(t).toLocaleDateString("sk-SK",{weekday:"short",day:"2-digit",month:"2-digit"}))}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:e.check_in?K(e.check_in):"-"}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:e.check_out?K(e.check_out):"-"}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:e.total_hours?(()=>{const t=e.total_hours,a=Math.floor(t),r=Math.round(60*(t-a));return"".concat(a,":").concat(r.toString().padStart(2,"0"))})():"-"}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:e.break_minutes?(()=>{const t=e.break_minutes,a=Math.floor(t/60),r=t%60;return"".concat(a,":").concat(r.toString().padStart(2,"0"))})():"-"}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat("present"===e.status?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"late"===e.status?"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200":"holiday"===e.status?"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200":"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200"),children:i.hrService.getAttendanceStatusLabel(e.status)})}),!S&&Y&&(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-600 dark:text-blue-400",children:(0,o.jsx)("button",{onClick:()=>{I({date:e.date,status:"holiday"===e.status?"absent":e.status,start_time:e.check_in?K(e.check_in)+(5===K(e.check_in).length?":00":""):void 0,end_time:e.check_out?K(e.check_out)+(5===K(e.check_out).length?":00":""):void 0,break_minutes:e.break_minutes||0,note:e.notes||""}),W(!0)},className:"hover:underline",children:"Upravi\u0165"})})]},e.id);var t})})]})}),z&&P&&(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,o.jsxs)("div",{className:"bg-white dark:bg-dark-800 rounded-lg p-6 w-full max-w-md",children:[(0,o.jsxs)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:["Upravi\u0165 de\u0148 ",new Date(P.date).toLocaleDateString("sk-SK")]}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Stav"}),(0,o.jsxs)("select",{value:P.status,onChange:e=>I(t=>t?(0,r.A)((0,r.A)({},t),{},{status:e.target.value}):t),className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md bg-white dark:bg-dark-700 text-gray-900 dark:text-white",children:[(0,o.jsx)("option",{value:"present",children:"Pr\xedtomn\xfd"}),(0,o.jsx)("option",{value:"absent",children:"Nepr\xedtomn\xfd"}),(0,o.jsx)("option",{value:"vacation",children:"Dovolenka"}),(0,o.jsx)("option",{value:"sick_leave",children:"PN"})]})]}),"present"===P.status&&(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Pr\xedchod"}),(0,o.jsx)("input",{type:"time",value:(P.start_time||"").slice(0,5),onChange:e=>I(t=>t?(0,r.A)((0,r.A)({},t),{},{start_time:e.target.value}):t),className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md bg-white dark:bg-dark-700 text-gray-900 dark:text-white"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Odchod"}),(0,o.jsx)("input",{type:"time",value:(P.end_time||"").slice(0,5),onChange:e=>I(t=>t?(0,r.A)((0,r.A)({},t),{},{end_time:e.target.value}):t),className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md bg-white dark:bg-dark-700 text-gray-900 dark:text-white"})]}),(0,o.jsxs)("div",{className:"col-span-2",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Prest\xe1vka (min)"}),(0,o.jsx)("input",{type:"number",min:0,value:P.break_minutes||0,onChange:e=>I(t=>t?(0,r.A)((0,r.A)({},t),{},{break_minutes:Number(e.target.value)}):t),className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md bg-white dark:bg-dark-700 text-gray-900 dark:text-white"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Pozn\xe1mka"}),(0,o.jsx)("input",{type:"text",value:P.note||"",onChange:e=>I(t=>t?(0,r.A)((0,r.A)({},t),{},{note:e.target.value}):t),className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md bg-white dark:bg-dark-700 text-gray-900 dark:text-white"})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-3 pt-2",children:[(0,o.jsx)("button",{onClick:()=>{W(!1),I(null)},className:"px-4 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-dark-600 rounded-md hover:bg-gray-50 dark:hover:bg-dark-700",children:"Zru\u0161i\u0165"}),(0,o.jsx)("button",{onClick:async()=>{if(P)try{const e="vacation"===P.status?"leave":P.status,r=a||_;if(!r)return;await i.hrService.updateAttendanceDay({employee_id:r,company_id:t,date:P.date,attendance_type:e,start_time:"present"===P.status&&P.start_time?"".concat(P.start_time,":00"):null,end_time:"present"===P.status&&P.end_time?"".concat(P.end_time,":00"):null,break_minutes:"present"===P.status&&P.break_minutes||0,note:P.note||""}),W(!1),I(null),await O()}catch(e){alert((null===e||void 0===e?void 0:e.message)||"Chyba pri ukladan\xed doch\xe1dzky")}},className:"px-4 py-2 bg-blue-600 dark:bg-blue-500 text-white rounded-md hover:bg-blue-700 dark:hover:bg-blue-600",children:"Ulo\u017ei\u0165"})]})]})]})})]})}}}]);