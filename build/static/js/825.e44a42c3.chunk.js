"use strict";(self.webpackChunkportal_app=self.webpackChunkportal_app||[]).push([[825,858],{28858:(e,a,t)=>{t.r(a),t.d(a,{hrService:()=>r});var n=t(39304);const r=new class{async getEmployees(e){return n.apiService.get("/hr/employees/".concat(e))}async addEmployee(e){return n.apiService.post("/hr/employees",e)}async updateEmployee(e,a){return n.apiService.put("/hr/employees/".concat(e),a)}async getAttendance(e,a,t,r){let s="/hr/attendance/".concat(e);const i=new URLSearchParams;return a&&i.append("employeeId",a.toString()),t&&i.append("startDate",t),r&&i.append("endDate",r),i.toString()&&(s+="?".concat(i.toString())),n.apiService.get(s)}async checkAttendanceDuplicates(e,a,t,r){let s="/hr/attendance/check-duplicates/".concat(e);const i=new URLSearchParams;return a&&i.append("employeeId",a.toString()),t&&i.append("startDate",t),r&&i.append("endDate",r),i.toString()&&(s+="?".concat(i.toString())),n.apiService.get(s)}async addAttendance(e){return n.apiService.post("/hr/attendance",e)}async getLeaveRequests(e,a,t){let r="/hr/leave-requests/".concat(e);const s=new URLSearchParams;return a&&s.append("status",a),t&&s.append("employee_id",t.toString()),s.toString()&&(r+="?".concat(s.toString())),n.apiService.get(r)}async addLeaveRequest(e){return n.apiService.post("/hr/leave-requests",e)}async updateLeaveRequestStatus(e,a,t){return n.apiService.put("/hr/leave-requests/".concat(e,"/status"),{status:a,approved_by:t})}async getWorkShifts(e){return n.apiService.get("/hr/work-shifts/".concat(e))}async addWorkShift(e){return n.apiService.post("/hr/work-shifts",e)}async getHREvents(e,a,t){let r="/hr/hr-events/".concat(e);const s=new URLSearchParams;return a&&s.append("event_type",a),t&&s.append("employee_id",t.toString()),s.toString()&&(r+="?".concat(s.toString())),n.apiService.get(r)}async addHREvent(e){return n.apiService.post("/hr/hr-events",e)}async findEmployeeByEmail(e){return n.apiService.get("/hr/employees/find/".concat(encodeURIComponent(e)))}async updateEmployeeCompany(e,a){return n.apiService.put("/hr/employees/".concat(e,"/company"),{company_id:a})}async getHRStats(e){return n.apiService.get("/hr/hr-stats/".concat(e))}getEmploymentTypeLabel(e){return{full_time:"Pln\xfd \xfav\xe4zok",part_time:"\u010ciasto\u010dn\xfd \xfav\xe4zok",contract:"Dohoda",intern:"St\xe1\u017e"}[e]||e}getStatusLabel(e){return{active:"Akt\xedvny",inactive:"Neakt\xedvny",terminated:"Ukon\u010den\xfd",on_leave:"Na dovolenke"}[e]||e}getLeaveTypeLabel(e){return{vacation:"Dovolenka",sick_leave:"PN",personal_leave:"Osobn\xe9 vo\u013eno",maternity_leave:"Matersk\xe1 dovolenka",paternity_leave:"Otcovsk\xe1 dovolenka",unpaid_leave:"Neplaten\xe9 vo\u013eno"}[e]||e}getEventTypeLabel(e){return{hire:"N\xe1bor",termination:"Ukon\u010denie",promotion:"Pov\xfd\u0161enie",salary_change:"Zmena mzdy",position_change:"Zmena poz\xedcie",warning:"Upozornenie",recognition:"Uznanie"}[e]||e}getAttendanceStatusLabel(e){return{present:"Pr\xedtomn\xfd",absent:"Nepr\xedtomn\xfd",late:"Me\u0161kanie",early_leave:"Pred\u010dasn\xfd odchod",sick_leave:"PN",vacation:"Dovolenka",holiday:"Sviatok"}[e]||e}calculateWorkHours(e,a){if(!e||!a)return 0;const t=new Date("2000-01-01T".concat(e)),n=(new Date("2000-01-01T".concat(a)).getTime()-t.getTime())/36e5;return Math.round(100*n)/100}formatTime(e){return e?e.substring(0,5):""}formatDate(e){return new Date(e).toLocaleDateString("sk-SK")}formatDateTime(e){return new Date(e).toLocaleString("sk-SK")}async createEmployeeChange(e){return n.apiService.post("/hr/employee-changes",e)}async getEmployeeChanges(e){return n.apiService.get("/hr/employee-changes/".concat(e))}async getCompanyChanges(e){return n.apiService.get("/hr/company-changes/".concat(e))}async approveEmployeeChange(e,a){return n.apiService.patch("/hr/employee-changes/".concat(e),{status:"approved",approved_by:a})}async rejectEmployeeChange(e,a){return n.apiService.patch("/hr/employee-changes/".concat(e),{status:"rejected",approved_by:a})}async updateEmployeeField(e,a,t){return n.apiService.patch("/hr/employees/".concat(e,"/update-field"),{field_name:a,new_value:t})}async getAttendanceSettings(e){return n.apiService.get("/hr/attendance-settings/".concat(e))}async createAutomaticAttendance(e,a){return n.apiService.post("/hr/attendance/auto-create",{companyId:e,date:a})}async addAttendanceWithType(e){return n.apiService.post("/hr/attendance",e)}async getEmploymentRelations(e){return n.apiService.get("/hr/employment-relations/".concat(e))}async addEmploymentRelation(e){return n.apiService.post("/hr/employment-relations",e)}async updateEmploymentRelation(e,a){return n.apiService.put("/hr/employment-relations/".concat(e),a)}async getEmployeesWithAutomaticAttendance(e){return n.apiService.get("/hr/employees/automatic-attendance/".concat(e))}async processAutomaticAttendance(e,a,t,r){return n.apiService.post("/hr/attendance/process-automatic",{companyId:e,employeeIds:a,startDate:t,endDate:r})}async getPresentEmployeesToday(e){return n.apiService.get("/hr/attendance/present-today/".concat(e))}async getAbsentEmployeesToday(e){return n.apiService.get("/hr/attendance/absent-today/".concat(e))}async getEmployeesAttendanceStatus(e){return n.apiService.get("/hr/employees/attendance-status/".concat(e))}async getEmployeesWithMissingAttendance(e){return n.apiService.get("/hr/employees/missing-attendance/".concat(e))}async recordAttendance(e){return n.apiService.post("/hr/attendance/record",e)}}},35601:(e,a,t)=>{t.d(a,{A:()=>d});var n=t(22555),r=t(65043),s=t(87438),i=t(77591),c=t(39304),o=t(28858),l=t(70579);const d=e=>{let{isOpen:a,onClose:t,onSend:d,senderEmail:p,userRole:m,companyId:u,initialRecipient:y="",initialSubject:h=""}=e;const[g,v]=(0,r.useState)(y),[x,b]=(0,r.useState)(h),[f,j]=(0,r.useState)(""),[S,N]=(0,r.useState)("general"),[w,_]=(0,r.useState)(!1),[k,C]=(0,r.useState)(""),[A,E]=(0,r.useState)([]),[T,R]=(0,r.useState)(!1),[z,D]=(0,r.useState)([]),[U,P]=(0,r.useState)(u),[I,L]=(0,r.useState)(!1);(0,r.useEffect)(()=>{v(y)},[y]),(0,r.useEffect)(()=>{a&&(async()=>{if("admin"===m||"accountant"===m)try{let e;L(!0),e="admin"===m?await c.apiService.getAllCompanies():await c.apiService.getAccountantCompanies(p),D(e)}catch(k){console.error("Chyba pri na\u010d\xedtan\xed firiem:",k)}finally{L(!1)}})()},[a,m,p]),(0,r.useEffect)(()=>{a&&(async()=>{try{R(!0);const e=await c.apiService.getAllUsers();let a=e;if("user"===m){const t=[],n=[];if(u)try{const e=await o.hrService.getEmployees(u);n.push(...e.map(e=>e.email));const a=await c.apiService.getCompanyById(u);a&&a.assignedToAccountants&&t.push(...a.assignedToAccountants)}catch(k){console.error("Chyba pri na\u010d\xedtan\xed zamestnancov pre firmu ".concat(u,":"),k)}else{const e=await c.apiService.getUserCompanies(p);for(const a of e){a.assignedToAccountants&&t.push(...a.assignedToAccountants);try{const e=await o.hrService.getEmployees(a.id);n.push(...e.map(e=>e.email))}catch(k){console.error("Chyba pri na\u010d\xedtan\xed zamestnancov pre firmu ".concat(a.id,":"),k)}}}a=e.filter(e=>"admin"===e.role||"accountant"===e.role&&t.includes(e.email)||"employee"===e.role&&n.includes(e.email))}else if("accountant"===m){const t=await c.apiService.getAccountantCompanies(p),n=[];t.forEach(e=>{e.owner_email&&n.push(e.owner_email)}),a=e.filter(e=>"admin"===e.role||"user"===e.role&&n.includes(e.email))}else if("employee"===m&&u){const t=await c.apiService.getCompanyById(u);if(t&&t.owner_email){const r=e.find(e=>e.email===t.owner_email);r&&(a=[(0,n.A)((0,n.A)({},r),{},{name:"".concat(t.name," (").concat(r.name,")")})])}}E(a)}catch(k){console.error("Chyba pri na\u010d\xedtan\xed pou\u017e\xedvate\u013eov:",k)}finally{R(!1)}})()},[a,m,p,u]);const O=()=>{v(y),b(h),j(""),N("general"),C(""),t()};return a?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(s.A,{className:"h-6 w-6 text-blue-600"}),(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Nov\xe1 spr\xe1va"})]}),(0,l.jsx)("button",{onClick:O,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,l.jsx)(i.A,{className:"h-6 w-6"})})]}),(0,l.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),g&&x&&f.trim()){_(!0),C("");try{console.log("Odosielam spr\xe1vu:",{sender_email:p,recipient_email:g,subject:x.trim(),content:f.trim(),company_id:U,message_type:S});const e=await c.apiService.sendMessage({sender_email:p,recipient_email:g,subject:x.trim(),content:f.trim(),company_id:U,message_type:S});console.log("Spr\xe1va odoslan\xe1 \xfaspe\u0161ne:",e),v(""),b(""),j(""),N("general"),alert("Spr\xe1va bola \xfaspe\u0161ne odoslan\xe1!"),d(),t()}catch(k){console.error("Chyba pri odosielan\xed spr\xe1vy:",k),C(k instanceof Error?k.message:"Chyba pri odosielan\xed spr\xe1vy")}finally{_(!1)}}else C("V\u0161etky polia musia by\u0165 vyplnen\xe9")},className:"p-6 space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"recipient",className:"block text-sm font-medium text-gray-700 mb-2",children:"Pr\xedjemca *"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("input",{type:"email",id:"recipient",value:g,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"email@example.com",required:!0}),T?(0,l.jsx)("div",{className:"absolute right-3 top-2.5",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"})}):(0,l.jsxs)("select",{onChange:e=>v(e.target.value),className:"absolute right-3 top-2.5 text-sm text-blue-600 hover:text-blue-700 cursor-pointer",children:[(0,l.jsx)("option",{value:"",children:"Vybra\u0165 pou\u017e\xedvate\u013ea"}),A.map(e=>(0,l.jsxs)("option",{value:e.email,children:[e.name," (",e.email,") - ",e.role]},e.id))]})]})]}),("admin"===m||"accountant"===m)&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"company",className:"block text-sm font-medium text-gray-700 mb-2",children:"Firma (pre ktor\xfa sa spr\xe1va posiela)"}),(0,l.jsx)("div",{className:"relative",children:(0,l.jsxs)("select",{id:"company",value:U||"",onChange:e=>P(e.target.value?Number(e.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Vybra\u0165 firmu (volite\u013en\xe9)"}),I?(0,l.jsx)("option",{value:"",disabled:!0,children:"Na\u010d\xedtavam firmy..."}):z.map(e=>(0,l.jsxs)("option",{value:e.id,children:[e.name," - ",e.owner_email]},e.id))]})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700 mb-2",children:"Predmet *"}),(0,l.jsx)("input",{type:"text",id:"subject",value:x,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Zadajte predmet spr\xe1vy",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"messageType",className:"block text-sm font-medium text-gray-700 mb-2",children:"Typ spr\xe1vy"}),(0,l.jsxs)("select",{id:"messageType",value:S,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"general",children:"V\u0161eobecn\xe1"}),(0,l.jsx)("option",{value:"question",children:"Ot\xe1zka"}),(0,l.jsx)("option",{value:"report",children:"Report"}),(0,l.jsx)("option",{value:"urgent",children:"Urgentn\xe1"}),(0,l.jsx)("option",{value:"welcome",children:"Vitaj\xfaca"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-2",children:"Obsah spr\xe1vy *"}),(0,l.jsx)("textarea",{id:"content",value:f,onChange:e=>j(e.target.value),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",placeholder:"Nap\xed\u0161te obsah spr\xe1vy...",required:!0})]}),k&&(0,l.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:(0,l.jsx)("p",{className:"text-sm text-red-800",children:k})}),(0,l.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,l.jsx)("button",{type:"button",onClick:O,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Zru\u0161i\u0165"}),(0,l.jsx)("button",{type:"submit",disabled:w,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:w?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Odosielam..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.A,{className:"h-4 w-4 mr-2"}),"Odosla\u0165 spr\xe1vu"]})})]})]})]})}):null}},39825:(e,a,t)=>{t.d(a,{A:()=>y});var n=t(22555),r=t(65043),s=t(38682),i=t(44832),c=t(89531),o=t(87438),l=t(79248),d=t(39304),p=t(28858),m=t(35601),u=t(70579);const y=e=>{let{userEmail:a,userRole:t,companyId:y,isAdmin:h=!1,onMessageAction:g}=e;const[v,x]=(0,r.useState)([]),[b,f]=(0,r.useState)(!0),[j,S]=(0,r.useState)(!1),[N,w]=(0,r.useState)(null),[_,k]=(0,r.useState)("all"),C=(0,r.useCallback)(async()=>{try{let e;f(!0);if(!d.apiService.getToken())return console.log("Pou\u017e\xedvate\u013e nie je prihl\xe1sen\xfd, presko\u010denie na\u010d\xedtania spr\xe1v"),void x([]);console.log("Na\u010d\xedtavam spr\xe1vy pre:",{userEmail:a,userRole:t,companyId:y,isAdmin:h}),h?e=await d.apiService.getAllMessages():"employee"===t&&y?(console.log("Pou\u017e\xedvam user endpoint pre employee:",a),e=await d.apiService.getUserMessages(a)):e=y?await d.apiService.getCompanyMessages(y):await d.apiService.getUserMessages(a),console.log("Na\u010d\xedtan\xe9 spr\xe1vy:",e),console.log("Po\u010det spr\xe1v:",e.length),x(e)}catch(e){console.error("Chyba pri na\u010d\xedtan\xed spr\xe1v:",e),x([])}finally{f(!1)}},[h,y,a,t]);(0,r.useEffect)(()=>{d.apiService.getToken()&&a&&C()},[a,y,h,C]);const[A,E]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{let e=v.filter(e=>"unread"===_?!e.read_at&&e.recipient_email===a:"received"===_?e.recipient_email===a:"sent"!==_||e.sender_email===a);if("user"===t){const t=await d.apiService.getUserCompanies(a),r=[],s=[];for(const e of t){e.assignedToAccountants&&r.push(...e.assignedToAccountants);try{const a=await p.hrService.getEmployees(e.id);s.push(...a.map(e=>e.email))}catch(n){console.error("Chyba pri na\u010d\xedtan\xed zamestnancov pre firmu ".concat(e.id,":"),n)}}e=e.filter(e=>"admin@portal.sk"===e.sender_email||r.includes(e.sender_email)||s.includes(e.sender_email)||e.sender_email===a)}else if("accountant"===t){const t=await d.apiService.getAccountantCompanies(a),n=[];t.forEach(e=>{e.owner_email&&n.push(e.owner_email)}),e=e.filter(e=>"admin@portal.sk"===e.sender_email||n.includes(e.sender_email)||e.sender_email===a)}else if("employee"===t)if(console.log("Filtrovanie pre employee:",{userEmail:a,companyId:y}),console.log("V\u0161etky spr\xe1vy pred filtrovan\xedm:",v),y){const t=await d.apiService.getCompanyById(y);console.log("Company data:",t),t&&t.owner_email&&(console.log("Company owner email:",t.owner_email),console.log("User email:",a),e=e.filter(e=>{const n=e.sender_email===t.owner_email,r=e.recipient_email===t.owner_email,s=e.sender_email===a,i=e.recipient_email===a;return console.log("Message:",e.subject,{isFromCompany:n,isToCompany:r,isFromUser:s,isToUser:i,sender:e.sender_email,recipient:e.recipient_email}),n||r||s||i}),console.log("Filtrovan\xe9 spr\xe1vy pre employee:",e))}else console.log("companyId nie je nastaven\xe9 pre employee");E(e)})()},[v,_,a,t]);const T=e=>{switch(e){case"urgent":return(0,u.jsx)("span",{className:"text-red-500",children:"\ud83d\udea8"});case"question":return(0,u.jsx)("span",{className:"text-blue-500",children:"\u2753"});case"report":return(0,u.jsx)("span",{className:"text-green-500",children:"\ud83d\udcca"});case"welcome":return(0,u.jsx)("span",{className:"text-purple-500",children:"\ud83d\udc4b"});default:return(0,u.jsx)(s.A,{className:"h-4 w-4 text-gray-500"})}},R=e=>{switch(e){case"urgent":return"Urgentn\xe1";case"question":return"Ot\xe1zka";case"report":return"Report";case"welcome":return"Vitaj\xfaca";default:return"V\u0161eobecn\xe1"}};return b?(0,u.jsxs)("div",{className:"text-center py-12",children:[(0,u.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,u.jsx)("p",{className:"mt-4 text-gray-600",children:"Na\u010d\xedtavam spr\xe1vy..."})]}):(0,u.jsxs)("div",{className:"space-y-6",children:[(0,u.jsxs)("div",{className:"flex justify-between items-center",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Spr\xe1vy"}),(0,u.jsxs)("p",{className:"text-gray-600 mt-1",children:[A.length," spr\xe1v","unread"===_&&(0,u.jsxs)("span",{className:"text-blue-600 font-medium",children:[" ","(",A.filter(e=>!e.read_at&&e.recipient_email===a).length," nepre\u010d\xedtan\xfdch)"]})]})]}),(0,u.jsxs)("button",{onClick:()=>S(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center gap-2 transition-colors",children:[(0,u.jsx)(o.A,{className:"h-4 w-4"}),"Nov\xe1 spr\xe1va"]})]}),(0,u.jsxs)("div",{className:"flex space-x-2",children:[(0,u.jsxs)("button",{onClick:()=>k("all"),className:"px-3 py-1 text-sm rounded-md ".concat("all"===_?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["V\u0161etky (",v.length,")"]}),(0,u.jsxs)("button",{onClick:()=>k("unread"),className:"px-3 py-1 text-sm rounded-md ".concat("unread"===_?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Nepre\u010d\xedtan\xe9 (",v.filter(e=>!e.read_at&&e.recipient_email===a).length,")"]}),(0,u.jsxs)("button",{onClick:()=>k("received"),className:"px-3 py-1 text-sm rounded-md ".concat("received"===_?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Prijat\xe9 (",v.filter(e=>e.recipient_email===a).length,")"]}),(0,u.jsxs)("button",{onClick:()=>k("sent"),className:"px-3 py-1 text-sm rounded-md ".concat("sent"===_?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Odoslan\xe9 (",v.filter(e=>e.sender_email===a).length,")"]})]}),(0,u.jsx)("div",{className:"space-y-4",children:0===A.length?(0,u.jsxs)("div",{className:"text-center py-12",children:[(0,u.jsx)(s.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,u.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"\u017diadne spr\xe1vy"}),(0,u.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"all"===_?"Zatia\u013e nem\xe1te \u017eiadne spr\xe1vy.":"unread"===_?"V\u0161etky spr\xe1vy s\xfa pre\u010d\xedtan\xe9.":"received"===_?"Zatia\u013e ste neprijali \u017eiadne spr\xe1vy.":"Zatia\u013e ste neodoslali \u017eiadne spr\xe1vy."})]}):A.map(e=>(0,u.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 ".concat(e.read_at?"border-gray-200":"border-blue-500"),children:(0,u.jsxs)("div",{className:"flex items-start justify-between",children:[(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-2",children:[T(e.message_type),(0,u.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:e.subject}),(0,u.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:R(e.message_type)}),!e.read_at&&e.recipient_email===a&&(0,u.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Nov\xe9"})]}),(0,u.jsxs)("div",{className:"mt-2 space-y-1 text-sm text-gray-600",children:[(0,u.jsxs)("p",{children:[(0,u.jsx)("span",{className:"font-medium",children:"Od:"})," ",e.sender_name||e.sender_email]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("span",{className:"font-medium",children:"Pre:"})," ",e.recipient_name||e.recipient_email]}),e.company_name&&(0,u.jsxs)("p",{children:[(0,u.jsx)("span",{className:"font-medium",children:"Firma:"})," ",e.company_name]}),(0,u.jsx)("p",{className:"text-gray-500",children:new Date(e.created_at).toLocaleString("sk-SK")})]}),(0,u.jsx)("p",{className:"text-gray-700 mt-3",children:e.content})]}),(0,u.jsxs)("div",{className:"flex space-x-2 ml-4",children:[(e.recipient_email===a||h)&&(0,u.jsx)("button",{onClick:()=>e.read_at?(async e=>{try{await d.apiService.markMessageAsUnread(e),x(a=>a.map(a=>a.id===e?(0,n.A)((0,n.A)({},a),{},{read_at:void 0}):a)),null===g||void 0===g||g()}catch(a){console.error("Chyba pri ozna\u010den\xed spr\xe1vy ako nepre\u010d\xedtan\xe1:",a)}})(e.id):(async e=>{try{await d.apiService.markMessageAsRead(e),x(a=>a.map(a=>a.id===e?(0,n.A)((0,n.A)({},a),{},{read_at:(new Date).toISOString()}):a)),null===g||void 0===g||g()}catch(a){console.error("Chyba pri ozna\u010den\xed spr\xe1vy ako pre\u010d\xedtan\xe1:",a)}})(e.id),className:"text-gray-600 hover:text-gray-700 p-1",title:e.read_at?"Ozna\u010di\u0165 ako nepre\u010d\xedtan\xe9":"Ozna\u010di\u0165 ako pre\u010d\xedtan\xe9",children:e.read_at?(0,u.jsx)(i.A,{className:"h-4 w-4"}):(0,u.jsx)(c.A,{className:"h-4 w-4"})}),(0,u.jsx)("button",{onClick:()=>(e=>{w(e),S(!0)})(e),className:"text-blue-600 hover:text-blue-700 p-1",title:"Odpoveda\u0165",children:(0,u.jsx)(o.A,{className:"h-4 w-4"})}),(0,u.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Naozaj chcete vymaza\u0165 t\xfato spr\xe1vu?"))try{await d.apiService.deleteMessage(e),x(a=>a.filter(a=>a.id!==e)),null===g||void 0===g||g()}catch(a){console.error("Chyba pri vymazan\xed spr\xe1vy:",a)}})(e.id),className:"text-red-600 hover:text-red-700 p-1",title:"Vymaza\u0165",children:(0,u.jsx)(l.A,{className:"h-4 w-4"})})]})]})},e.id))}),(0,u.jsx)(m.A,{isOpen:j,onClose:()=>{S(!1),w(null)},onSend:()=>{C(),null===g||void 0===g||g()},senderEmail:a,userRole:t,companyId:y,initialRecipient:(null===N||void 0===N?void 0:N.sender_email)===a?N.recipient_email:null===N||void 0===N?void 0:N.sender_email,initialSubject:N?"Re: ".concat(N.subject):""})]})}}}]);
//# sourceMappingURL=825.e44a42c3.chunk.js.map