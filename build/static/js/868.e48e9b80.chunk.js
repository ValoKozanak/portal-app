"use strict";(self.webpackChunkclient_portal_frontend=self.webpackChunkclient_portal_frontend||[]).push([[868],{92868:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var s=t(9950),l=t(96011),r=t.n(l),n=t(44414);const o=e=>{let{onBack:a}=e;const[t,l]=(0,s.useState)([]),[o,d]=(0,s.useState)(!1),[i,c]=(0,s.useState)(null),[m,x]=(0,s.useState)(null),[h,b]=(0,s.useState)(""),[p,u]=(0,s.useState)("2025"),[g,y]=(0,s.useState)([]),[j,f]=(0,s.useState)(!1),v=async()=>{try{var e;const a="https://api.client-portal.sk",t=h?"".concat(a,"/api/accounting/admin/mdb/files/").concat(h):"".concat(a,"/api/accounting/admin/mdb/files"),s=((null===(e=(await r().get(t,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})).data)||void 0===e?void 0:e.files)||[]).map(e=>({name:e.name||e.key||"",size:"number"===typeof e.size?e.size:0,mtime:e.mtime||e.lastModified||null}));l(s)}catch(i){c("Chyba pri na\u010d\xedtan\xed s\xfaborov: "+i.message)}};return(0,s.useEffect)(()=>{(async()=>{try{f(!0);const e=await r().get("".concat("https://api.client-portal.sk","/api/companies"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});y(e.data||[])}catch(i){c("Chyba pri na\u010d\xedtan\xed firiem: "+i.message)}finally{f(!1)}})()},[]),(0,s.useEffect)(()=>{v()},[h]),(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsx)("div",{className:"bg-white shadow",children:(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,n.jsx)("div",{className:"flex justify-between h-16",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("button",{onClick:a,className:"mr-4 p-2 text-gray-400 hover:text-gray-600 rounded-md",children:"\u2190 Sp\xe4\u0165 na Dashboard"}),(0,n.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"MDB Management"})]})})})}),(0,n.jsx)("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,n.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"MDB Management"}),(0,n.jsxs)("div",{className:"mb-8 p-4 border border-gray-200 rounded-lg",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Upload nov\xe9ho MDB s\xfaboru"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Firma"}),(0,n.jsxs)("select",{value:h,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:j,children:[(0,n.jsx)("option",{value:"",children:"-- Vyberte firmu --"}),g.map(e=>(0,n.jsxs)("option",{value:e.ico,children:[e.name," (I\u010cO: ",e.ico,")"]},e.id))]}),j&&(0,n.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Na\u010d\xedtavam firmy..."})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rok"}),(0,n.jsxs)("select",{value:p,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"2025",children:"2025"}),(0,n.jsx)("option",{value:"2024",children:"2024"}),(0,n.jsx)("option",{value:"2023",children:"2023"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"MDB s\xfabor"}),(0,n.jsx)("input",{type:"file",accept:".mdb",onChange:async e=>{const a=e.target.files[0];if(a&&h){d(!0),c(null);try{const t=new FormData;t.append("file",a),t.append("year",p);await r().post("".concat("https://api.client-portal.sk","/api/accounting/admin/mdb/upload/").concat(h),t,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"multipart/form-data"}});x("MDB s\xfabor ".concat(a.name," bol \xfaspe\u0161ne nahran\xfd!")),v(),e.target.value=""}catch(i){c("Upload zlyhal: "+i.message)}finally{d(!1)}}},disabled:o||!h,className:"w-full"})]})]}),o&&(0,n.jsx)("p",{className:"text-sm text-blue-600",children:"Uploadujem..."})]}),(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Dostupn\xe9 MDB s\xfabory ",h?"(I\u010cO ".concat(h,")"):""]}),(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsx)("button",{onClick:v,className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700",children:"Obnovi\u0165 zoznam"})}),0===t.length?(0,n.jsx)("p",{className:"text-gray-500",children:"\u017diadne MDB s\xfabory neboli n\xe1jden\xe9"}):(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full bg-white border border-gray-200",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"bg-gray-50",children:[(0,n.jsx)("th",{className:"px-4 py-2 border border-gray-200 text-left",children:"N\xe1zov s\xfaboru"}),(0,n.jsx)("th",{className:"px-4 py-2 border border-gray-200 text-left",children:"Ve\u013ekos\u0165"}),(0,n.jsx)("th",{className:"px-4 py-2 border border-gray-200 text-left",children:"D\xe1tum \xfapravy"}),(0,n.jsx)("th",{className:"px-4 py-2 border border-gray-200 text-left",children:"Akcie"})]})}),(0,n.jsx)("tbody",{children:t.map((e,a)=>(0,n.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,n.jsx)("td",{className:"px-4 py-2 border border-gray-200",children:e.name}),(0,n.jsx)("td",{className:"px-4 py-2 border border-gray-200",children:e.size?"".concat((e.size/1024/1024).toFixed(2)," MB"):"N/A"}),(0,n.jsx)("td",{className:"px-4 py-2 border border-gray-200",children:e.mtime?new Date(e.mtime).toLocaleString("sk-SK"):"N/A"}),(0,n.jsx)("td",{className:"px-4 py-2 border border-gray-200",children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>(async e=>{try{if(!h)return c("Vyber firmu pre stiahnutie s\xfaboru");const a="".concat("https://api.client-portal.sk","/api/accounting/admin/mdb/download/").concat(h,"/").concat(encodeURIComponent(e)),t=await r().get(a,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},responseType:"blob"}),s=window.URL.createObjectURL(new Blob([t.data])),l=document.createElement("a");l.href=s,l.download=e,document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(s)}catch(i){var a,t;c("Stiahnutie zlyhalo: "+((null===(a=i.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.error)||i.message))}})(e.name),className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",disabled:!h,children:"Stiahnu\u0165"}),(0,n.jsx)("button",{onClick:()=>(async e=>{try{if(!h)return c("Vyber firmu pre zmazanie s\xfaboru");const a="".concat("https://api.client-portal.sk","/api/accounting/admin/mdb/file/").concat(h,"/").concat(encodeURIComponent(e));await r().delete(a,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),x("MDB s\xfabor ".concat(e," bol odstr\xe1nen\xfd")),v()}catch(i){var a,t;c("Zmazanie zlyhalo: "+((null===(a=i.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.error)||i.message))}})(e.name),className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50",disabled:!h,children:"Zmaza\u0165"})]})})]},a))})]})})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,n.jsx)("h4",{className:"font-semibold text-blue-800",children:"Celkovo s\xfaborov"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:t.length})]}),(0,n.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,n.jsx)("h4",{className:"font-semibold text-green-800",children:"Celkov\xe1 ve\u013ekos\u0165"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-green-600",children:t.reduce((e,a)=>e+(a.size||0),0)/1024/1024>0?"".concat((t.reduce((e,a)=>e+(a.size||0),0)/1024/1024).toFixed(2)," MB"):"0 MB"})]}),(0,n.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,n.jsx)("h4",{className:"font-semibold text-purple-800",children:"Posledn\xe1 aktualiz\xe1cia"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:t.length>0&&t[0].lastModified?new Date(t[0].lastModified).toLocaleDateString("sk-SK"):"N/A"})]})]}),i&&(0,n.jsx)("div",{className:"mt-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:i}),m&&(0,n.jsx)("div",{className:"mt-6 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:m}),(0,n.jsxs)("div",{className:"mt-8 bg-gray-50 p-4 rounded-lg",children:[(0,n.jsx)("h4",{className:"font-semibold text-gray-800 mb-2",children:"Ako to funguje:"}),(0,n.jsxs)("ol",{className:"text-sm text-gray-600 space-y-1 list-decimal list-inside",children:[(0,n.jsx)("li",{children:"Vyberte I\u010cO firmy a rok pre upload"}),(0,n.jsx)("li",{children:"Nahrajte MDB s\xfabor (.mdb)"}),(0,n.jsx)("li",{children:"S\xfabor sa automaticky ulo\u017e\xed na server"})]})]})]})})]})}}}]);