"use strict";(self.webpackChunkclient_portal_frontend=self.webpackChunkclient_portal_frontend||[]).push([[999],{2460:(e,t,a)=>{a.d(t,{B:()=>o});var s=a(22555),n=a(50237);const o=new class{async getSettings(e){return await n.apiService.get("/accounting/settings/".concat(e))}async saveSettings(e,t){return await n.apiService.post("/accounting/settings/".concat(e),t)}async getPermissions(e,t){return await n.apiService.get("/accounting/permissions/".concat(e,"/").concat(t))}async savePermissions(e,t){return await n.apiService.post("/accounting/permissions/".concat(e),t)}async getAllPermissions(e){return await n.apiService.get("/accounting/permissions/".concat(e))}async getIssuedInvoices(e,t){const a=new URLSearchParams;t&&Object.entries(t).forEach(e=>{let[t,s]=e;void 0!==s&&a.append(t,s.toString())});return await n.apiService.get("/accounting/issued-invoices/".concat(e,"?").concat(a))}async createIssuedInvoice(e,t){return await n.apiService.post("/accounting/issued-invoices/".concat(e),t)}async getIssuedInvoiceById(e){return await n.apiService.get("/accounting/issued-invoices/detail/".concat(e))}async getReceivedInvoices(e,t){const a=new URLSearchParams;t&&Object.entries(t).forEach(e=>{let[t,s]=e;void 0!==s&&a.append(t,s.toString())});return await n.apiService.get("/accounting/received-invoices/".concat(e,"?").concat(a))}async getReceivedInvoiceById(e){return await n.apiService.get("/accounting/received-invoices/detail/".concat(e))}async getPudSummary(e){return await n.apiService.get("/accounting/pud-summary/".concat(e))}async getFinancialAnalysis(e,t,a){let s="/accounting/financial-analysis/".concat(e);const o=new URLSearchParams;t&&o.append("dateFrom",t),a&&o.append("dateTo",a),o.toString()&&(s+="?".concat(o.toString()));return await n.apiService.get(s)}async getStats(e,t){const a=new URLSearchParams;t&&Object.entries(t).forEach(e=>{let[t,s]=e;void 0!==s&&a.append(t,s.toString())});return await n.apiService.get("/accounting/stats/".concat(e,"?").concat(a))}formatCurrency(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EUR";return new Intl.NumberFormat("sk-SK",{style:"currency",currency:t}).format(e)}formatDate(e){return new Date(e).toLocaleDateString("sk-SK")}getStatusBadge(e){return{draft:{text:"Koncept",color:"bg-gray-100 text-gray-800"},sent:{text:"Odoslan\xe1",color:"bg-blue-100 text-blue-800"},paid:{text:"Zaplaten\xe1",color:"bg-green-100 text-green-800"},overdue:{text:"Po splatnosti",color:"bg-red-100 text-red-800"},cancelled:{text:"Zru\u0161en\xe1",color:"bg-yellow-100 text-yellow-800"},received:{text:"Prijat\xe1",color:"bg-gray-100 text-gray-800"},approved:{text:"Schv\xe1len\xe1",color:"bg-blue-100 text-blue-800"},disputed:{text:"Sporn\xe1",color:"bg-orange-100 text-orange-800"}}[e]||{text:e,color:"bg-gray-100 text-gray-800"}}getTypeBadge(e){return{income:{text:"Pr\xedjem",color:"bg-green-100 text-green-800"},expense:{text:"V\xfddavok",color:"bg-red-100 text-red-800"}}[e]||{text:e,color:"bg-gray-100 text-gray-800"}}async testPohodaConnection(e,t){return await n.apiService.post("/accounting/test-pohoda-connection",(0,s.A)({companyId:e},t))}async testPohodaInvoices(e,t){return await n.apiService.post("/accounting/test-pohoda-invoices",(0,s.A)({companyId:e},t))}async syncPohodaInvoices(e,t,a){return await n.apiService.post("/accounting/sync-pohoda-invoices/".concat(e),{dateFrom:t,dateTo:a})}async uploadPohodaXml(e,t){const a=new FormData;a.append("xmlFile",t);const s=await fetch("".concat("https://musical-stardust-faabdb.netlify.app","/api/accounting/upload-pohoda-xml/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:a});if(!s.ok)throw new Error("Chyba pri nahr\xe1van\xed XML s\xfaboru");return await s.json()}async exportPohodaXml(e,t,a){const s=await fetch("".concat("https://musical-stardust-faabdb.netlify.app","/api/accounting/export-pohoda-xml/").concat(e,"?dateFrom=").concat(t||"","&dateTo=").concat(a||""),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!s.ok)throw new Error("Chyba pri exporte XML s\xfaboru");return await s.blob()}async refreshInvoicesFromMdb(e){const t=localStorage.getItem("dropbox_access_token");if(!t)throw new Error("Dropbox token nie je dostupn\xfd. Pripojte sa k Dropboxu.");const a=await fetch("".concat("https://musical-stardust-faabdb.netlify.app","/api/accounting/refresh-invoices/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});if(!a.ok)throw new Error("Chyba pri obnoven\xed fakt\xfar z MDB");return await a.json()}async refreshReceivedInvoicesFromMdb(e){const t=localStorage.getItem("dropbox_access_token");if(!t)throw new Error("Dropbox token nie je dostupn\xfd. Pripojte sa k Dropboxu.");const a=await fetch("".concat("https://musical-stardust-faabdb.netlify.app","/api/accounting/refresh-received-invoices/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});if(!a.ok)throw new Error("Chyba pri obnoven\xed prijat\xfdch fakt\xfar z MDB");return await a.json()}async importInvoicesFromMdb(e){const t=await fetch("".concat("https://musical-stardust-faabdb.netlify.app","/api/accounting/import-invoices/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(!t.ok)throw new Error("Chyba pri importe fakt\xfar z MDB");return await t.json()}async deleteIssuedInvoice(e){return await n.apiService.delete("/accounting/issued-invoices/".concat(e))}async deleteReceivedInvoice(e){return await n.apiService.delete("/accounting/received-invoices/".concat(e))}async deleteBankTransaction(e){return await n.apiService.delete("/accounting/bank-transactions/".concat(e))}async deleteCashTransaction(e){return await n.apiService.delete("/accounting/cash-transactions/".concat(e))}async getDirectory(e){const t=await fetch("".concat("https://musical-stardust-faabdb.netlify.app","/api/accounting/directory/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(!t.ok)throw new Error("Chyba pri na\u010d\xedtan\xed adres\xe1ra");return await t.json()}async getVatReturns(e,t){const a=t||(new Date).getFullYear(),s=await fetch("".concat("https://musical-stardust-faabdb.netlify.app","/api/accounting/vat-returns/").concat(e,"?year=").concat(a),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(!s.ok)throw new Error("Chyba pri na\u010d\xedtan\xed DPH podan\xed");return await s.json()}async getBankAccounts(e){console.log("\ud83c\udfe6 Vol\xe1m bankov\xfd endpoint pre companyId:",e);const t=await fetch("".concat("https://musical-stardust-faabdb.netlify.app","/api/accounting/bank-accounts/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(console.log("\ud83c\udfe6 Bankov\xfd endpoint response status:",t.status),!t.ok)throw new Error("Chyba pri na\u010d\xedtan\xed bankov\xfdch \xfa\u010dtov");const a=await t.json();return console.log("\ud83c\udfe6 Bankov\xfd endpoint response data:",a),a}async getCashAccounts(e){const t=await fetch("".concat("https://musical-stardust-faabdb.netlify.app","/api/accounting/cash-accounts/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(!t.ok)throw new Error("Chyba pri na\u010d\xedtan\xed poklad\u0148ov\xfdch \xfa\u010dtov");return await t.json()}async getBankTransactions(e,t){console.log("\ud83c\udfe6 Vol\xe1m bankov\xfd transak\u010dn\xfd endpoint pre companyId:",e,"accountNumber:",t);const a=await fetch("http://localhost:5000/api/accounting/bank-transactions/".concat(e,"/").concat(t),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(console.log("\ud83c\udfe6 Bankov\xfd transak\u010dn\xfd endpoint response status:",a.status),!a.ok)throw new Error("Chyba pri na\u010d\xedtan\xed bankov\xfdch transakci\xed");const s=await a.json();return console.log("\ud83c\udfe6 Bankov\xfd transak\u010dn\xfd endpoint response data:",s),s}async getCashTransactions(e,t){console.log("\ud83d\udcb0 Vol\xe1m poklad\u0148ov\xfd transak\u010dn\xfd endpoint pre companyId:",e,"accountNumber:",t);const a=await fetch("http://localhost:5000/api/accounting/cash-transactions/".concat(e,"/").concat(t),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(console.log("\ud83d\udcb0 Poklad\u0148ov\xfd transak\u010dn\xfd endpoint response status:",a.status),!a.ok)throw new Error("Chyba pri na\u010d\xedtan\xed poklad\u0148ov\xfdch transakci\xed");const s=await a.json();return console.log("\ud83d\udcb0 Poklad\u0148ov\xfd transak\u010dn\xfd endpoint response data:",s),s}}},2765:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(53986),n=a(9950);const o=["title","titleId"];function r(e,t){let{title:a,titleId:r}=e,c=(0,s.A)(e,o);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},c),a?n.createElement("title",{id:r},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const c=n.forwardRef(r)},11999:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var s=a(9950),n=a(14185),o=a(38158),r=a(2765),c=a(63421),i=a(50259),l=a(2460),d=a(50237),m=a(22555),u=a(15536),p=a(64725),h=a(75516),x=a(44414);const b=e=>{var t;let{companyId:a}=e;const[n,o]=(0,s.useState)(null),[r,c]=(0,s.useState)(!1),[i,d]=(0,s.useState)(!1),[m,u]=(0,s.useState)(null),[p,h]=(0,s.useState)(""),[b,g]=(0,s.useState)("");return(0,x.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,x.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"POHODA XML Import/Export"}),(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,x.jsx)("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Import fakt\xfar z POHODA XML"}),(0,x.jsxs)("div",{className:"space-y-3",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"xml-file-input",className:"block text-sm font-medium text-gray-700 mb-1",children:"Vyberte XML s\xfabor z POHODA"}),(0,x.jsx)("input",{id:"xml-file-input",type:"file",accept:".xml",onChange:e=>{var t;const a=null===(t=e.target.files)||void 0===t?void 0:t[0];!a||"application/xml"!==a.type&&"text/xml"!==a.type?alert("Pros\xedm vyberte XML s\xfabor"):(o(a),u(null))},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),(0,x.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Podporovan\xe9 s\xfa len XML s\xfabory exportovan\xe9 z POHODA"})]}),n&&(0,x.jsx)("div",{className:"bg-blue-50 p-3 rounded-md",children:(0,x.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,x.jsx)("strong",{children:"Vybran\xfd s\xfabor:"})," ",n.name," (",(n.size/1024).toFixed(1)," KB)"]})}),(0,x.jsx)("button",{onClick:async()=>{if(n){c(!0),u(null);try{const e=await l.B.uploadPohodaXml(a,n);u({success:e.success,message:e.message||"Upload dokon\u010den\xfd",details:e.data}),o(null);const t=document.getElementById("xml-file-input");t&&(t.value="")}catch(e){console.error("Chyba pri upload:",e),u({success:!1,message:"Chyba pri nahr\xe1van\xed XML s\xfaboru"})}finally{c(!1)}}else alert("Pros\xedm vyberte XML s\xfabor")},disabled:!n||r,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:r?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Nahr\xe1vam..."]}):"Nahra\u0165 XML s\xfabor"})]}),m&&(0,x.jsxs)("div",{className:"mt-4 p-3 rounded-md ".concat(m.success?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:[(0,x.jsx)("p",{className:"text-sm font-medium",children:m.message}),m.details&&(0,x.jsxs)("div",{className:"mt-2 text-xs",children:[(0,x.jsxs)("p",{children:["Importovan\xe9: ",m.details.imported]}),(0,x.jsxs)("p",{children:["Chyby: ",(null===(t=m.details.errors)||void 0===t?void 0:t.length)||0]}),m.details.errors&&m.details.errors.length>0&&(0,x.jsx)("ul",{className:"mt-1 list-disc list-inside",children:m.details.errors.map((e,t)=>(0,x.jsx)("li",{children:e},t))})]})]})]}),(0,x.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,x.jsx)("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Export fakt\xfar do POHODA XML"}),(0,x.jsxs)("div",{className:"space-y-3",children:[(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"date-from",className:"block text-sm font-medium text-gray-700 mb-1",children:"D\xe1tum od"}),(0,x.jsx)("input",{id:"date-from",type:"date",value:p,onChange:e=>h(e.target.value),className:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"date-to",className:"block text-sm font-medium text-gray-700 mb-1",children:"D\xe1tum do"}),(0,x.jsx)("input",{id:"date-to",type:"date",value:b,onChange:e=>g(e.target.value),className:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,x.jsx)("p",{className:"text-sm text-gray-500",children:"Ak nevyberiete d\xe1tumy, exportuj\xfa sa v\u0161etky fakt\xfary"}),(0,x.jsx)("button",{onClick:async()=>{d(!0);try{const e=await l.B.exportPohodaXml(a,p,b),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="pohoda_invoices_".concat(a,"_").concat((new Date).toISOString().split("T")[0],".xml"),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(t),document.body.removeChild(s)}catch(e){console.error("Chyba pri exporte:",e),alert("Chyba pri exporte XML s\xfaboru")}finally{d(!1)}},disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Exportujem..."]}):"Exportova\u0165 do XML"})]})]}),(0,x.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,x.jsx)("h4",{className:"text-md font-medium text-yellow-800 mb-2",children:"Ako to funguje"}),(0,x.jsxs)("div",{className:"text-sm text-yellow-700 space-y-1",children:[(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Import:"})," Exportujte fakt\xfary z POHODA do XML s\xfaboru a nahrajte ich tu"]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Export:"})," Stiahnite fakt\xfary v POHODA XML form\xe1te pre import do POHODA"]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Kompatibilita:"})," Funguje s demo aj plnou verziou POHODA"]})]})]})]})]})},g=e=>{let{isOpen:t,onClose:a,companyId:n,settings:o,onSave:r}=e;const[c,i]=(0,s.useState)({pohoda_enabled:!1,pohoda_url:"",pohoda_username:"",pohoda_password:"",pohoda_ico:"",pohoda_year:"",auto_sync:!1,sync_frequency:"daily"}),[d,g]=(0,s.useState)(!1),[y,f]=(0,s.useState)(null);(0,s.useEffect)(()=>{o&&i({pohoda_enabled:o.pohoda_enabled||!1,pohoda_url:o.pohoda_url||"",pohoda_username:o.pohoda_username||"",pohoda_password:o.pohoda_password||"",pohoda_ico:o.pohoda_ico||"",pohoda_year:o.pohoda_year||"",auto_sync:o.auto_sync||!1,sync_frequency:o.sync_frequency||"daily"})},[o]);const v=e=>{const{name:t,value:a,type:s}=e.target,n=e.target.checked;i(e=>(0,m.A)((0,m.A)({},e),{},{[t]:"checkbox"===s?n:a}))},j=()=>c.pohoda_url&&c.pohoda_username&&c.pohoda_password&&c.pohoda_ico&&c.pohoda_year;return t?(0,x.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,x.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,x.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Nastavenia POHODA integr\xe1cie"}),(0,x.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:(0,x.jsx)(u.A,{className:"h-6 w-6"})})]}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),g(!0);try{await r({pohoda_enabled:c.pohoda_enabled,pohoda_url:c.pohoda_url,pohoda_username:c.pohoda_username,pohoda_password:c.pohoda_password,pohoda_ico:c.pohoda_ico,pohoda_year:c.pohoda_year,auto_sync:c.auto_sync,sync_frequency:c.sync_frequency}),a()}catch(t){console.error("Chyba pri ukladan\xed nastaven\xed:",t)}finally{g(!1)}},className:"p-6 space-y-6",children:[(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Z\xe1kladn\xe9 nastavenia"}),(0,x.jsxs)("div",{className:"flex items-center",children:[(0,x.jsx)("input",{type:"checkbox",id:"pohoda_enabled",name:"pohoda_enabled",checked:c.pohoda_enabled,onChange:v,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,x.jsx)("label",{htmlFor:"pohoda_enabled",className:"ml-2 block text-sm text-gray-900",children:"Povoli\u0165 POHODA integr\xe1ciu"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"pohoda_url",className:"block text-sm font-medium text-gray-700",children:"POHODA mServer URL *"}),(0,x.jsx)("input",{type:"url",id:"pohoda_url",name:"pohoda_url",value:c.pohoda_url,onChange:v,placeholder:"http://localhost:8080",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:c.pohoda_enabled})]}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"pohoda_username",className:"block text-sm font-medium text-gray-700",children:"Pou\u017e\xedvate\u013esk\xe9 meno *"}),(0,x.jsx)("input",{type:"text",id:"pohoda_username",name:"pohoda_username",value:c.pohoda_username,onChange:v,placeholder:"admin",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:c.pohoda_enabled})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"pohoda_password",className:"block text-sm font-medium text-gray-700",children:"Heslo *"}),(0,x.jsx)("input",{type:"password",id:"pohoda_password",name:"pohoda_password",value:c.pohoda_password,onChange:v,placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:c.pohoda_enabled})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"pohoda_ico",className:"block text-sm font-medium text-gray-700",children:"I\u010cO firmy v POHODA *"}),(0,x.jsx)("input",{type:"text",id:"pohoda_ico",name:"pohoda_ico",value:c.pohoda_ico,onChange:v,placeholder:"12345678",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:c.pohoda_enabled})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"pohoda_year",className:"block text-sm font-medium text-gray-700",children:"Rok firmy v POHODA (I\u010cO_ROK) *"}),(0,x.jsx)("input",{type:"text",id:"pohoda_year",name:"pohoda_year",value:c.pohoda_year,onChange:v,placeholder:"2024",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:c.pohoda_enabled}),(0,x.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Ak m\xe1te viacero firiem s rovnak\xfdm I\u010cO, zadajte rok (napr. 2024 pre I\u010cO_2024)"})]})]}),(0,x.jsxs)("div",{className:"mt-6 border-t pt-6",children:[(0,x.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"POHODA Nastavenia - mServer"}),!c.pohoda_enabled&&(0,x.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4",children:(0,x.jsx)("p",{className:"text-sm text-gray-600",children:"Pre pou\u017eitie mServer integr\xe1cie najprv povolte POHODA integr\xe1ciu vy\u0161\u0161ie."})}),(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,x.jsx)("h4",{className:"text-md font-medium text-blue-800 mb-2",children:"Testovanie mServer spojenia"}),(0,x.jsx)("p",{className:"text-sm text-blue-700 mb-3",children:"Testujte pripojenie k POHODA mServer pre automatick\xfa synchroniz\xe1ciu fakt\xfar."}),(0,x.jsxs)("div",{className:"space-y-2",children:[(0,x.jsx)("button",{type:"button",onClick:async()=>{g(!0),f(null);try{const e=await fetch("/api/accounting/test-pohoda-connection",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({companyId:n,pohoda_url:c.pohoda_url,pohoda_username:c.pohoda_username,pohoda_password:c.pohoda_password,pohoda_ico:c.pohoda_ico,pohoda_year:c.pohoda_year})}),t=await e.json();t.success?f({success:!0,message:"Spojenie s POHODA mServer je \xfaspe\u0161n\xe9!"}):f({success:!1,message:t.error||"Nepodarilo sa pripoji\u0165 k POHODA mServer"})}catch(e){f({success:!1,message:"Chyba pri testovan\xed spojenia"})}finally{g(!1)}},disabled:!c.pohoda_enabled||!j(),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:d?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Testujem..."]}):"Testova\u0165 spojenie"}),(0,x.jsx)("button",{type:"button",onClick:async()=>{g(!0),f(null);try{const e=await l.B.testPohodaInvoices(n,{pohoda_url:c.pohoda_url,pohoda_username:c.pohoda_username,pohoda_password:c.pohoda_password,pohoda_ico:c.pohoda_ico,pohoda_year:c.pohoda_year});f({success:e.success,message:e.message||(e.success?"Fakt\xfary \xfaspe\u0161ne na\u010d\xedtan\xe9":"Chyba pri na\u010d\xedtan\xed fakt\xfar")})}catch(e){console.error("Chyba pri testovan\xed fakt\xfar:",e),f({success:!1,message:"Chyba pri testovan\xed fakt\xfar"})}finally{g(!1)}},disabled:!c.pohoda_enabled||!j(),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:d?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Testujem fakt\xfary..."]}):"Testova\u0165 fakt\xfary"}),(0,x.jsx)("button",{type:"button",onClick:async()=>{g(!0),f(null);try{const e=await l.B.syncPohodaInvoices(n);f({success:e.success,message:e.message||(e.success?"Synchroniz\xe1cia \xfaspe\u0161n\xe1":"Chyba pri synchroniz\xe1cii")})}catch(e){console.error("Chyba pri synchroniz\xe1cii:",e),f({success:!1,message:"Chyba pri synchroniz\xe1cii fakt\xfar"})}finally{g(!1)}},disabled:!c.pohoda_enabled||!j(),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",children:d?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Synchronizujem..."]}):"Synchronizova\u0165 fakt\xfary"})]}),y&&(0,x.jsxs)("div",{className:"flex items-center p-3 rounded-md mt-3 ".concat(y.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[y.success?(0,x.jsx)(p.A,{className:"h-5 w-5 text-green-400 mr-2"}):(0,x.jsx)(h.A,{className:"h-5 w-5 text-red-400 mr-2"}),(0,x.jsx)("span",{className:"text-sm ".concat(y.success?"text-green-800":"text-red-800"),children:y.message})]})]}),c.pohoda_enabled&&(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsx)("h4",{className:"text-md font-medium text-gray-700",children:"Automatick\xe1 synchroniz\xe1cia"}),(0,x.jsxs)("div",{className:"flex items-center",children:[(0,x.jsx)("input",{type:"checkbox",id:"auto_sync",name:"auto_sync",checked:c.auto_sync,onChange:v,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,x.jsx)("label",{htmlFor:"auto_sync",className:"ml-2 block text-sm text-gray-900",children:"Automatick\xe1 synchroniz\xe1cia"})]}),c.auto_sync&&(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"sync_frequency",className:"block text-sm font-medium text-gray-700",children:"Frekvencia synchroniz\xe1cie"}),(0,x.jsxs)("select",{id:"sync_frequency",name:"sync_frequency",value:c.sync_frequency,onChange:v,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[(0,x.jsx)("option",{value:"hourly",children:"Ka\u017ed\xfa hodinu"}),(0,x.jsx)("option",{value:"daily",children:"Denne"}),(0,x.jsx)("option",{value:"weekly",children:"T\xfd\u017edenne"}),(0,x.jsx)("option",{value:"manual",children:"Manu\xe1lne"})]})]})]})]})]}),(0,x.jsxs)("div",{className:"mt-6 border-t pt-6",children:[(0,x.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"POHODA Nastavenia - XML"}),(0,x.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[(0,x.jsx)("h4",{className:"text-md font-medium text-yellow-800 mb-2",children:"XML Import/Export"}),(0,x.jsx)("p",{className:"text-sm text-yellow-700",children:"Manu\xe1lny import/export fakt\xfar cez XML s\xfabory. Funguje s demo aj plnou verziou POHODA."})]}),(0,x.jsx)(b,{companyId:n})]}),(0,x.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[(0,x.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Zru\u0161i\u0165"}),(0,x.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:d?"Uklad\xe1m...":"Ulo\u017ei\u0165 nastavenia"})]})]})]})}):null},y=e=>{let{onBack:t}=e;const[a,m]=(0,s.useState)([]),[u,p]=(0,s.useState)(null),[h,b]=(0,s.useState)(null),[y,f]=(0,s.useState)([]),[v,j]=(0,s.useState)(!1),[w,k]=(0,s.useState)(!1);(0,s.useEffect)(()=>{N()},[]);const N=async()=>{try{const e=await d.apiService.getAllCompanies();m(e),e.length>0&&p(e[0].id)}catch(e){console.error("Chyba pri na\u010d\xedtan\xed firiem:",e)}},_=async e=>{try{const[t,a]=await Promise.all([l.B.getSettings(e),l.B.getAllPermissions(e)]);b(t),f(a)}catch(t){console.error("Chyba pri na\u010d\xedtan\xed d\xe1t firmy:",t)}};(0,s.useEffect)(()=>{u&&_(u)},[u]);const S=e=>l.B.formatDate(e);return(0,x.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,x.jsx)("div",{className:"bg-white shadow",children:(0,x.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,x.jsx)("div",{className:"flex justify-between h-16",children:(0,x.jsxs)("div",{className:"flex items-center",children:[(0,x.jsx)("button",{onClick:t,className:"mr-4 p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100",children:(0,x.jsx)(n.A,{className:"h-6 w-6"})}),(0,x.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"POHODA mServer Nastavenia"})]})})})}),(0,x.jsxs)("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:[(0,x.jsxs)("div",{className:"mb-6",children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vyberte firmu"}),(0,x.jsx)("select",{value:u||"",onChange:e=>p(Number(e.target.value)),className:"block w-full max-w-xs rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:a.map(e=>(0,x.jsx)("option",{value:e.id,children:e.name},e.id))})]}),u&&(0,x.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,x.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,x.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,x.jsx)(o.A,{className:"h-5 w-5 mr-2 text-indigo-600"}),"POHODA mServer Nastavenia"]}),(0,x.jsx)("button",{onClick:()=>j(!0),className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Upravi\u0165"})]})}),(0,x.jsx)("div",{className:"p-6",children:h?(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Stav integr\xe1cie"}),(0,x.jsxs)("div",{className:"flex items-center",children:[h.pohoda_enabled?(0,x.jsx)(r.A,{className:"h-5 w-5 text-green-500 mr-2"}):(0,x.jsx)(c.A,{className:"h-5 w-5 text-red-500 mr-2"}),(0,x.jsx)("span",{className:"text-sm ".concat(h.pohoda_enabled?"text-green-600":"text-red-600"),children:h.pohoda_enabled?"Akt\xedvna":"Neakt\xedvna"})]})]}),h.pohoda_enabled&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"I\u010cO firmy v POHODA"}),(0,x.jsx)("span",{className:"text-sm text-gray-900",children:h.pohoda_ico||"-"})]}),(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Rok firmy v POHODA"}),(0,x.jsx)("span",{className:"text-sm text-gray-900",children:h.pohoda_year||"-"})]}),(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Automatick\xe1 synchroniz\xe1cia"}),(0,x.jsx)("span",{className:"text-sm text-gray-900",children:h.auto_sync?"Zapnut\xe1":"Vypnut\xe1"})]}),(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Frekvencia synchroniz\xe1cie"}),(0,x.jsxs)("span",{className:"text-sm text-gray-900",children:["hourly"===h.sync_frequency&&"Ka\u017ed\xfa hodinu","daily"===h.sync_frequency&&"Denne","weekly"===h.sync_frequency&&"T\xfd\u017edenne","manual"===h.sync_frequency&&"Manu\xe1lne"]})]}),h.last_sync&&(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Posledn\xe1 synchroniz\xe1cia"}),(0,x.jsx)("span",{className:"text-sm text-gray-900",children:S(h.last_sync)})]})]})]}):(0,x.jsx)("p",{className:"text-gray-500 text-center py-4",children:"\u017diadne nastavenia POHODA"})})]}),(0,x.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,x.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,x.jsx)(i.A,{className:"h-5 w-5 mr-2 text-blue-600"}),"Pr\xe1va pre \xfa\u010dtovn\xedctvo"]}),(0,x.jsx)("button",{onClick:()=>k(!0),className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Prida\u0165 pr\xe1va"})]})}),(0,x.jsx)("div",{className:"p-6",children:y.length>0?(0,x.jsx)("div",{className:"space-y-3",children:y.map(e=>(0,x.jsxs)("div",{className:"border rounded-md p-3",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,x.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.user_email}),(0,x.jsx)("span",{className:"text-xs text-gray-500",children:e.granted_at?S(e.granted_at):"-"})]}),(0,x.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.can_view_invoices&&(0,x.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Zobrazi\u0165 fakt\xfary"}),e.can_create_invoices&&(0,x.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Vytvori\u0165 fakt\xfary"}),e.can_edit_invoices&&(0,x.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Upravi\u0165 fakt\xfary"}),e.can_view_bank&&(0,x.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"Zobrazi\u0165 banku"}),e.can_edit_bank&&(0,x.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:"Upravi\u0165 banku"}),e.can_view_cash&&(0,x.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-pink-100 text-pink-800",children:"Zobrazi\u0165 poklad\u0148u"}),e.can_edit_cash&&(0,x.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Upravi\u0165 poklad\u0148u"}),e.can_manage_settings&&(0,x.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Spravova\u0165 nastavenia"})]})]},e.id))}):(0,x.jsx)("p",{className:"text-gray-500 text-center py-4",children:"\u017diadne pr\xe1va pre \xfa\u010dtovn\xedctvo"})})]})]}),v&&h&&(0,x.jsx)(g,{isOpen:v,onClose:()=>j(!1),companyId:u,settings:h,onSave:async e=>{try{await l.B.saveSettings(u,e),await _(u),j(!1)}catch(t){console.error("Chyba pri ukladan\xed POHODA nastaven\xed:",t)}}})]})]})}},14185:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(53986),n=a(9950);const o=["title","titleId"];function r(e,t){let{title:a,titleId:r}=e,c=(0,s.A)(e,o);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},c),a?n.createElement("title",{id:r},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const c=n.forwardRef(r)},38158:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(53986),n=a(9950);const o=["title","titleId"];function r(e,t){let{title:a,titleId:r}=e,c=(0,s.A)(e,o);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},c),a?n.createElement("title",{id:r},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25"}))}const c=n.forwardRef(r)},50259:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(53986),n=a(9950);const o=["title","titleId"];function r(e,t){let{title:a,titleId:r}=e,c=(0,s.A)(e,o);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},c),a?n.createElement("title",{id:r},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const c=n.forwardRef(r)},63421:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(53986),n=a(9950);const o=["title","titleId"];function r(e,t){let{title:a,titleId:r}=e,c=(0,s.A)(e,o);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},c),a?n.createElement("title",{id:r},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const c=n.forwardRef(r)},64725:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(53986),n=a(9950);const o=["title","titleId"];function r(e,t){let{title:a,titleId:r}=e,c=(0,s.A)(e,o);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},c),a?n.createElement("title",{id:r},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const c=n.forwardRef(r)}}]);