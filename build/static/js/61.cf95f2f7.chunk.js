"use strict";(self.webpackChunkclient_portal_frontend=self.webpackChunkclient_portal_frontend||[]).push([[61],{86061:(e,a,t)=>{t.r(a),t.d(a,{default:()=>O});var s=t(22555),r=t(9950),i=t(2599),n=t(50259),l=t(37619),d=t(2765),c=t(7342),o=t(64112),m=t(61506),x=t(57491),h=t(77081),u=t(15536),p=t(44414);const g=e=>{let{isOpen:a,onClose:t,onSave:i,currentProfile:n}=e;const[l,d]=(0,r.useState)(n),[c,o]=(0,r.useState)(!1),[m,x]=(0,r.useState)({}),h=e=>{const{name:a,value:t}=e.target;d(e=>(0,s.A)((0,s.A)({},e),{},{[a]:t})),m[a]&&x(e=>(0,s.A)((0,s.A)({},e),{},{[a]:""}))},g=()=>{d(n),x({}),t()};return a?(0,p.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[(0,p.jsxs)("div",{className:"flex justify-between items-center p-6 border-b",children:[(0,p.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Upravi\u0165 profil"}),(0,p.jsx)("button",{onClick:g,className:"text-gray-400 hover:text-gray-600",children:(0,p.jsx)(u.A,{className:"h-6 w-6"})})]}),(0,p.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),(()=>{const e={};return l.name.trim()?l.name.trim().length<2&&(e.name="Meno mus\xed ma\u0165 aspo\u0148 2 znaky"):e.name="Meno je povinn\xe9",l.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email)||(e.email="Neplatn\xfd form\xe1t emailu"):e.email="Email je povinn\xfd",l.phone&&!/^[+]?[0-9\s\-()]{9,}$/.test(l.phone)&&(e.phone="Neplatn\xfd form\xe1t telef\xf3nneho \u010d\xedsla"),x(e),0===Object.keys(e).length})()&&(o(!0),setTimeout(()=>{i(l),o(!1),t()},1e3))},className:"p-6",children:[(0,p.jsxs)("div",{className:"space-y-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Meno a priezvisko *"}),(0,p.jsx)("input",{type:"text",id:"name",name:"name",value:l.name,onChange:h,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(m.name?"border-red-300":"border-gray-300"),placeholder:"Zadajte meno a priezvisko"}),m.name&&(0,p.jsx)("p",{className:"mt-1 text-sm text-red-600",children:m.name})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),(0,p.jsx)("input",{type:"email",id:"email",name:"email",value:l.email,onChange:h,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(m.email?"border-red-300":"border-gray-300"),placeholder:"pouzivatel@email.sk"}),m.email&&(0,p.jsx)("p",{className:"mt-1 text-sm text-red-600",children:m.email})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Telef\xf3nne \u010d\xedslo"}),(0,p.jsx)("input",{type:"tel",id:"phone",name:"phone",value:l.phone,onChange:h,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(m.phone?"border-red-300":"border-gray-300"),placeholder:"+421 123 456 789"}),m.phone&&(0,p.jsx)("p",{className:"mt-1 text-sm text-red-600",children:m.phone})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-2",children:"O mne"}),(0,p.jsx)("textarea",{id:"bio",name:"bio",value:l.bio,onChange:h,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Nap\xed\u0161te nie\u010do o sebe..."})]})]}),(0,p.jsxs)("div",{className:"mt-6 flex space-x-3",children:[(0,p.jsx)("button",{type:"button",onClick:g,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Zru\u0161i\u0165"}),(0,p.jsx)("button",{type:"submit",disabled:c,className:"flex-1 bg-primary-600 text-white py-2 px-4 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Uklad\xe1m...":"Ulo\u017ei\u0165 zmeny"})]})]})]})}):null},y=e=>{let{isOpen:a,onClose:t,onSave:i,currentCompany:n,isEditing:l=!1}=e;const[d,c]=(0,r.useState)(n?{id:n.id,name:n.name,ico:n.ico,address:n.address,business_registry:n.business_registry||"",vat_id:n.vat_id||"",tax_id:n.tax_id||"",authorized_person:n.authorized_person,contact_phone:n.contact_phone||"",contact_email:n.contact_email||""}:{name:"",ico:"",address:"",business_registry:"",vat_id:"",tax_id:"",authorized_person:"",contact_phone:"",contact_email:""}),[o,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)({}),g=e=>{const{name:a,value:t}=e.target;c(e=>(0,s.A)((0,s.A)({},e),{},{[a]:t})),x[a]&&h(e=>(0,s.A)((0,s.A)({},e),{},{[a]:""}))},y=()=>{c(n?{id:n.id,name:n.name,ico:n.ico,address:n.address,business_registry:n.business_registry||"",vat_id:n.vat_id||"",tax_id:n.tax_id||"",authorized_person:n.authorized_person,contact_phone:n.contact_phone||"",contact_email:n.contact_email||""}:{name:"",ico:"",address:"",business_registry:"",vat_id:"",tax_id:"",authorized_person:"",contact_phone:"",contact_email:""}),h({}),t()};return a?(0,p.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,p.jsxs)("div",{className:"flex justify-between items-center p-6 border-b",children:[(0,p.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:l?"Upravi\u0165 firmu":"Prida\u0165 nov\xfa firmu"}),(0,p.jsx)("button",{onClick:y,className:"text-gray-400 hover:text-gray-600",children:(0,p.jsx)(u.A,{className:"h-6 w-6"})})]}),(0,p.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return d.name.trim()||(e.name="N\xe1zov firmy je povinn\xfd"),d.ico.trim()?/^\d{8}$/.test(d.ico.replace(/\s/g,""))||(e.ico="I\u010cO mus\xed ma\u0165 8 \u010d\xedslic"):e.ico="I\u010cO je povinn\xe9",d.address.trim()||(e.address="Adresa je povinn\xe1"),d.vat_id&&!/^SK\d{10}$/.test(d.vat_id.replace(/\s/g,""))&&(e.vat_id="I\u010c DPH mus\xed ma\u0165 form\xe1t SK + 10 \u010d\xedslic"),d.tax_id&&!/^\d{10}$/.test(d.tax_id.replace(/\s/g,""))&&(e.tax_id="DI\u010c mus\xed ma\u0165 10 \u010d\xedslic"),d.authorized_person.trim()||(e.authorized_person="Osoba opr\xe1vnen\xe1 kona\u0165 je povinn\xe1"),d.contact_email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.contact_email)&&(e.contact_email="Neplatn\xfd form\xe1t emailu"),h(e),0===Object.keys(e).length})()){m(!0);try{const e=(0,s.A)((0,s.A)({},d),{},{id:(null===n||void 0===n?void 0:n.id)||void 0});await i(e),m(!1),t()}catch(a){console.error("Chyba pri ukladan\xed firmy:",a),m(!1)}}},className:"p-6",children:[(0,p.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,p.jsx)("div",{className:"md:col-span-2",children:(0,p.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Z\xe1kladn\xe9 \xfadaje"})}),(0,p.jsxs)("div",{className:"md:col-span-2",children:[(0,p.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"N\xe1zov firmy *"}),(0,p.jsx)("input",{type:"text",id:"name",name:"name",value:d.name,onChange:g,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(x.name?"border-red-300":"border-gray-300"),placeholder:"N\xe1zov spolo\u010dnosti"}),x.name&&(0,p.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.name})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"ico",className:"block text-sm font-medium text-gray-700 mb-2",children:"I\u010cO *"}),(0,p.jsx)("input",{type:"text",id:"ico",name:"ico",value:d.ico,onChange:g,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(x.ico?"border-red-300":"border-gray-300"),placeholder:"12345678",maxLength:8}),x.ico&&(0,p.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.ico})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"business_registry",className:"block text-sm font-medium text-gray-700 mb-2",children:"\u010c. obchodn\xe9ho registra *"}),(0,p.jsx)("input",{type:"text",id:"business_registry",name:"business_registry",value:d.business_registry,onChange:g,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(x.business_registry?"border-red-300":"border-gray-300"),placeholder:"12345/A"}),x.business_registry&&(0,p.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.business_registry})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"vat_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"I\u010c DPH"}),(0,p.jsx)("input",{type:"text",id:"vat_id",name:"vat_id",value:d.vat_id,onChange:g,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(x.vat_id?"border-red-300":"border-gray-300"),placeholder:"SK1234567890"}),x.vat_id&&(0,p.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.vat_id})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"tax_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"DI\u010c"}),(0,p.jsx)("input",{type:"text",id:"tax_id",name:"tax_id",value:d.tax_id,onChange:g,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(x.tax_id?"border-red-300":"border-gray-300"),placeholder:"1234567890"}),x.tax_id&&(0,p.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.tax_id})]}),(0,p.jsxs)("div",{className:"md:col-span-2",children:[(0,p.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresa *"}),(0,p.jsx)("input",{type:"text",id:"address",name:"address",value:d.address,onChange:g,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(x.address?"border-red-300":"border-gray-300"),placeholder:"Ulica, PS\u010c Mesto"}),x.address&&(0,p.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.address})]}),(0,p.jsxs)("div",{className:"md:col-span-2",children:[(0,p.jsx)("label",{htmlFor:"authorized_person",className:"block text-sm font-medium text-gray-700 mb-2",children:"Osoba opr\xe1vnen\xe1 kona\u0165 v mene firmy *"}),(0,p.jsx)("input",{type:"text",id:"authorized_person",name:"authorized_person",value:d.authorized_person,onChange:g,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(x.authorized_person?"border-red-300":"border-gray-300"),placeholder:"Meno a priezvisko"}),x.authorized_person&&(0,p.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.authorized_person})]}),(0,p.jsx)("div",{className:"md:col-span-2",children:(0,p.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4 mt-6",children:"Kontaktn\xe9 \xfadaje"})}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"contact_phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Telef\xf3n"}),(0,p.jsx)("input",{type:"tel",id:"contact_phone",name:"contact_phone",value:d.contact_phone,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"+421 123 456 789"})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"contact_email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,p.jsx)("input",{type:"email",id:"contact_email",name:"contact_email",value:d.contact_email,onChange:g,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(x.contact_email?"border-red-300":"border-gray-300"),placeholder:"firma@email.sk"}),x.contact_email&&(0,p.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.contact_email})]})]}),(0,p.jsxs)("div",{className:"mt-6 flex space-x-3",children:[(0,p.jsx)("button",{type:"button",onClick:y,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Zru\u0161i\u0165"}),(0,p.jsx)("button",{type:"submit",disabled:o,className:"flex-1 bg-primary-600 text-white py-2 px-4 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Uklad\xe1m...":l?"Ulo\u017ei\u0165 zmeny":"Prida\u0165 firmu"})]})]})]})}):null};var b=t(40423),f=t(14185),v=t(52941),j=t(20418),N=t(50237);const w=e=>{let{userEmail:a="user@portal.sk",onBack:t}=e;const[i,n]=(0,r.useState)([]),[l,d]=(0,r.useState)(!0),[m,h]=(0,r.useState)(!1),[u,g]=(0,r.useState)(null),[y,b]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{try{d(!0);const e=(await N.apiService.getUserTasks(a)).map(e=>({id:e.id.toString(),title:e.title,description:e.description||"",status:e.status,priority:e.priority,assignedTo:e.assigned_to,dueDate:e.due_date||"",createdAt:e.created_at,createdBy:e.created_by,category:"other"}));n(e)}catch(e){console.error("Chyba pri na\u010d\xedtan\xed \xfaloh:",e)}finally{d(!1)}})()},[a]),(0,r.useEffect)(()=>{(async()=>{try{const e=await N.apiService.getUserCompanies(a);b(e.map(e=>({id:e.id,name:e.name})))}catch(e){console.error("Chyba pri na\u010d\xedtan\xed firiem:",e)}})()},[a]);const w=()=>{g(null),h(!0)};return(0,p.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,p.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,p.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,p.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,p.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,p.jsxs)("button",{onClick:t,className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[(0,p.jsx)(f.A,{className:"h-5 w-5 mr-2"}),"Sp\xe4\u0165 do Dashboardu"]}),(0,p.jsx)("div",{className:"h-6 w-px bg-gray-300"}),(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)(c.A,{className:"h-8 w-8 text-orange-500 mr-3"}),(0,p.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Va\u0161e \xfalohy"})]})]}),(0,p.jsxs)("button",{onClick:w,className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 flex items-center transition-colors",children:[(0,p.jsx)(x.A,{className:"h-5 w-5 mr-2"}),"Prida\u0165 \xfalohu"]})]})})}),(0,p.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,p.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,p.jsx)("div",{className:"flex justify-between items-center",children:(0,p.jsxs)("div",{children:[(0,p.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Zoznam \xfaloh"}),(0,p.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Celkovo ",i.length," \xfaloh \u2022 ",i.filter(e=>"pending"===e.status).length," \u010dakaj\xfacich"]})]})})}),(0,p.jsx)("div",{className:"p-6",children:l?(0,p.jsxs)("div",{className:"text-center py-12",children:[(0,p.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,p.jsx)("p",{className:"mt-4 text-gray-600",children:"Na\u010d\xedtavam \xfalohy..."})]}):i.length>0?(0,p.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(e=>{return(0,p.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 hover:shadow-md transition-shadow border border-gray-200",children:[(0,p.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,p.jsxs)("div",{className:"flex-1",children:[(0,p.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:e.title}),(0,p.jsx)("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:e.description}),(0,p.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,p.jsx)(v.A,{className:"h-4 w-4 mr-1"}),e.dueDate]}),(0,p.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,p.jsx)(o.A,{className:"h-4 w-4 mr-1"}),e.assignedTo]})]}),(0,p.jsxs)("div",{className:"flex flex-col items-end space-y-2 ml-4",children:[(t=e.status,(0,p.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat({pending:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",in_progress:"bg-blue-100 text-blue-800",cancelled:"bg-gray-100 text-gray-800"}[t]||"bg-gray-100 text-gray-800"),children:{pending:"\u010cakaj\xface",completed:"Dokon\u010den\xe9",in_progress:"V spracovan\xed",cancelled:"Zru\u0161en\xe9"}[t]||t})),(a=e.priority,(0,p.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat({low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",urgent:"bg-red-100 text-red-800"}[a]||"bg-gray-100 text-gray-800"),children:{low:"N\xedzka",medium:"Stredn\xe1",high:"Vysok\xe1",urgent:"Urgentn\xe1"}[a]||a}))]})]}),(0,p.jsx)("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200",children:(0,p.jsxs)("div",{className:"flex space-x-2",children:[(0,p.jsx)("button",{onClick:()=>(e=>{g(e),h(!0)})(e),className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"Upravi\u0165"}),(0,p.jsx)("button",{onClick:()=>(async e=>{try{await N.apiService.deleteTask(parseInt(e)),n(a=>a.filter(a=>a.id!==e))}catch(a){console.error("Chyba pri mazan\xed \xfalohy:",a),alert("Chyba pri mazan\xed \xfalohy: "+(a instanceof Error?a.message:"Nezn\xe1ma chyba"))}})(e.id),className:"text-red-600 hover:text-red-700 text-sm font-medium",children:"Vymaza\u0165"})]})})]},e.id);var a,t})}):(0,p.jsxs)("div",{className:"text-center py-12",children:[(0,p.jsx)(c.A,{className:"mx-auto h-16 w-16 text-gray-400"}),(0,p.jsx)("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"\u017diadne \xfalohy"}),(0,p.jsx)("p",{className:"mt-2 text-sm text-gray-500 mb-6",children:"Zatia\u013e nem\xe1te \u017eiadne \xfalohy. Vytvorte prv\xfa \xfalohu pre va\u0161u firmu."}),(0,p.jsxs)("button",{onClick:w,className:"bg-primary-600 text-white px-6 py-3 rounded-md hover:bg-primary-700 flex items-center mx-auto",children:[(0,p.jsx)(x.A,{className:"h-5 w-5 mr-2"}),"Vytvori\u0165 prv\xfa \xfalohu"]})]})})]})}),(0,p.jsx)(j.A,{isOpen:m,onClose:()=>{h(!1),g(null)},onSave:async e=>{try{if(u)await N.apiService.updateTask(parseInt(u.id),{title:e.title,description:e.description,status:e.status,priority:e.priority,assigned_to:e.assignedTo,due_date:e.dueDate}),n(a=>a.map(a=>a.id===u.id?(0,s.A)((0,s.A)((0,s.A)({},a),e),{},{id:u.id,createdAt:a.createdAt}):a));else{if(0===y.length)return void alert("Pre vytvorenie \xfalohy potrebujete ma\u0165 aspo\u0148 jednu firmu.");const t=y[0],s=await N.apiService.createTask({title:e.title,description:e.description,status:e.status,priority:e.priority,assigned_to:e.assignedTo,due_date:e.dueDate,created_by:a,company_id:t.id,company_name:t.name}),r=await N.apiService.getTask(s.taskId),i={id:r.id.toString(),title:r.title,description:r.description||"",status:r.status,priority:r.priority,assignedTo:r.assigned_to,dueDate:r.due_date||"",createdAt:r.created_at,createdBy:r.created_by,category:"other"};n(e=>[...e,i])}h(!1),g(null)}catch(t){console.error("Chyba pri ukladan\xed \xfalohy:",t),alert("Chyba pri ukladan\xed \xfalohy: "+(t instanceof Error?t.message:"Nezn\xe1ma chyba"))}},task:u,companyEmployees:[],company:y.length>0?y[0]:void 0,userEmail:a})]})};var k=t(64725),_=t(39818),C=t(16467);const S=e=>{let{userEmail:a="user@portal.sk",onBack:t}=e;const[s,i]=(0,r.useState)([]),[n,d]=(0,r.useState)(!0),[c,m]=(0,r.useState)(""),[x,h]=(0,r.useState)("all"),[u,g]=(0,r.useState)("all");(0,r.useEffect)(()=>{(async()=>{try{d(!0),console.log("Na\u010d\xedtavam nepre\u010d\xedtan\xe9 spr\xe1vy pre:",a);const e=await N.apiService.getUnreadMessages(a);console.log("Na\u010d\xedtan\xe9 spr\xe1vy:",e),i(e)}catch(e){console.error("Chyba pri na\u010d\xedtan\xed nepre\u010d\xedtan\xfdch spr\xe1v:",e)}finally{d(!1)}})()},[a]);const y=s.filter(e=>{const a=e.subject.toLowerCase().includes(c.toLowerCase())||e.content.toLowerCase().includes(c.toLowerCase())||e.sender_name.toLowerCase().includes(c.toLowerCase()),t="all"===x||e.company_name&&e.company_name===x,s="all"===u||e.sender_email===u;return a&&t&&s}),b=Array.from(new Set(s.map(e=>e.company_name).filter(Boolean))),j=Array.from(new Set(s.map(e=>e.sender_email)));return(0,p.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,p.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,p.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,p.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,p.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,p.jsxs)("button",{onClick:t,className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[(0,p.jsx)(f.A,{className:"h-5 w-5 mr-2"}),"Sp\xe4\u0165 do Dashboardu"]}),(0,p.jsx)("div",{className:"h-6 w-px bg-gray-300"}),(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)(l.A,{className:"h-8 w-8 text-purple-500 mr-3"}),(0,p.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Nepre\u010d\xedtan\xe9 spr\xe1vy"})]})]}),y.length>0&&(0,p.jsxs)("button",{onClick:async()=>{try{await Promise.all(y.map(e=>N.apiService.markMessageAsRead(e.id))),i(e=>e.filter(e=>!y.find(a=>a.id===e.id)))}catch(e){console.error("Chyba pri ozna\u010den\xed v\u0161etk\xfdch spr\xe1v ako pre\u010d\xedtan\xe9:",e),alert("Chyba pri ozna\u010den\xed v\u0161etk\xfdch spr\xe1v ako pre\u010d\xedtan\xe9: "+(e instanceof Error?e.message:"Nezn\xe1ma chyba"))}},className:"bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 flex items-center transition-colors",children:[(0,p.jsx)(k.A,{className:"h-5 w-5 mr-2"}),"Ozna\u010di\u0165 v\u0161etky ako pre\u010d\xedtan\xe9"]})]})})}),(0,p.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,p.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,p.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,p.jsxs)("div",{children:[(0,p.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Zoznam nepre\u010d\xedtan\xfdch spr\xe1v"}),(0,p.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Celkovo ",s.length," nepre\u010d\xedtan\xfdch spr\xe1v",y.length!==s.length&&(0,p.jsxs)("span",{className:"ml-2 text-purple-600",children:["(Zobrazen\xe9: ",y.length,")"]})]})]})}),(0,p.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,p.jsx)(_.A,{className:"h-5 w-5 text-gray-400"})}),(0,p.jsx)("input",{type:"text",placeholder:"Vyh\u013eada\u0165 spr\xe1vy...",value:c,onChange:e=>m(e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm"})]}),(0,p.jsx)("div",{children:(0,p.jsxs)("select",{value:x,onChange:e=>h(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md leading-5 bg-white focus:outline-none focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",children:[(0,p.jsx)("option",{value:"all",children:"V\u0161etky firmy"}),b.map(e=>(0,p.jsx)("option",{value:e,children:e},e))]})}),(0,p.jsx)("div",{children:(0,p.jsxs)("select",{value:u,onChange:e=>g(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md leading-5 bg-white focus:outline-none focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",children:[(0,p.jsx)("option",{value:"all",children:"V\u0161etci odosielatelia"}),j.map(e=>(0,p.jsx)("option",{value:e,children:e},e))]})}),(0,p.jsx)("div",{children:(0,p.jsx)("button",{onClick:()=>{m(""),h("all"),g("all")},className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-purple-500 focus:border-purple-500",children:"Resetova\u0165 filtre"})})]})]}),(0,p.jsx)("div",{className:"p-6",children:n?(0,p.jsxs)("div",{className:"text-center py-12",children:[(0,p.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),(0,p.jsx)("p",{className:"mt-4 text-gray-600",children:"Na\u010d\xedtavam spr\xe1vy..."})]}):y.length>0?(0,p.jsx)("div",{className:"space-y-4",children:y.map(e=>{return(0,p.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 hover:shadow-md transition-shadow border border-gray-200",children:[(0,p.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,p.jsxs)("div",{className:"flex-1",children:[(0,p.jsxs)("div",{className:"flex items-center mb-2",children:[(0,p.jsx)("h3",{className:"text-lg font-medium text-gray-900 mr-3",children:e.subject}),(0,p.jsx)("span",{className:"bg-purple-100 text-purple-800 text-xs font-medium px-2 py-1 rounded-full",children:"Nepre\u010d\xedtan\xe9"})]}),(0,p.jsx)("p",{className:"text-sm text-gray-600 mb-3 line-clamp-3",children:e.content}),(0,p.jsxs)("div",{className:"flex items-center text-sm text-gray-500 space-x-4",children:[(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)(o.A,{className:"h-4 w-4 mr-1"}),(0,p.jsxs)("span",{children:["Od: ",e.sender_name," (",e.sender_email,")"]})]}),(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)(v.A,{className:"h-4 w-4 mr-1"}),(0,p.jsx)("span",{children:(a=e.created_at,new Date(a).toLocaleDateString("sk-SK",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))})]}),e.company_name&&(0,p.jsx)("div",{className:"flex items-center",children:(0,p.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:e.company_name})})]})]})}),(0,p.jsx)("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200",children:(0,p.jsxs)("div",{className:"flex space-x-2",children:[(0,p.jsxs)("button",{onClick:()=>(async e=>{try{await N.apiService.markMessageAsRead(e),i(a=>a.filter(a=>a.id!==e))}catch(a){console.error("Chyba pri ozna\u010den\xed spr\xe1vy ako pre\u010d\xedtan\xe1:",a),alert("Chyba pri ozna\u010den\xed spr\xe1vy ako pre\u010d\xedtan\xe1: "+(a instanceof Error?a.message:"Nezn\xe1ma chyba"))}})(e.id),className:"text-purple-600 hover:text-purple-700 text-sm font-medium flex items-center",children:[(0,p.jsx)(k.A,{className:"h-4 w-4 mr-1"}),"Ozna\u010di\u0165 ako pre\u010d\xedtan\xe9"]}),(0,p.jsxs)("button",{onClick:()=>(async e=>{try{await N.apiService.deleteMessage(e),i(a=>a.filter(a=>a.id!==e))}catch(a){console.error("Chyba pri mazan\xed spr\xe1vy:",a),alert("Chyba pri mazan\xed spr\xe1vy: "+(a instanceof Error?a.message:"Nezn\xe1ma chyba"))}})(e.id),className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center",children:[(0,p.jsx)(C.A,{className:"h-4 w-4 mr-1"}),"Vymaza\u0165"]})]})})]},e.id);var a})}):(0,p.jsxs)("div",{className:"text-center py-12",children:[(0,p.jsx)(l.A,{className:"mx-auto h-16 w-16 text-gray-400"}),(0,p.jsx)("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:s.length>0?"\u017diadne spr\xe1vy nevyhovuj\xfa filtrom":"\u017diadne nepre\u010d\xedtan\xe9 spr\xe1vy"}),(0,p.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:s.length>0?"Sk\xfaste zmeni\u0165 nastavenia filtrov alebo vyh\u013ead\xe1vania.":"V\u0161etky va\u0161e spr\xe1vy s\xfa pre\u010d\xedtan\xe9. Nov\xe9 spr\xe1vy sa zobrazia tu."})]})})]})})]})};var A=t(63421),z=t(75516),E=t(19530),D=t(92605),P=t(7609),U=t(82695);const V=e=>{let{userEmail:a,onBack:t}=e;const[i,n]=(0,r.useState)([]),[l,c]=(0,r.useState)([]),[m,x]=(0,r.useState)(null),[h,u]=(0,r.useState)(!0),[g,y]=(0,r.useState)(""),[b,j]=(0,r.useState)(!1),[w,k]=(0,r.useState)(null);(0,r.useEffect)(()=>{_()},[]);const _=async()=>{try{u(!0);const e=await N.apiService.getUserCompanies(a);if(c(e),e.length>0){x(e[0]);const a=await D.hrService.getEmployees(e[0].id),t=await Promise.all(a.map(async a=>{try{const[t,r]=await Promise.all([D.hrService.getAttendance(e[0].id,a.id),D.hrService.getLeaveRequests(e[0].id)]);return(0,s.A)((0,s.A)({},a),{},{attendance:t.filter(e=>e.employee_id===a.id),leave_requests:r.filter(e=>e.employee_id===a.id)})}catch(t){return console.error("Chyba pri na\u010d\xedtan\xed detailov pre zamestnanca ".concat(a.id,":"),t),(0,s.A)((0,s.A)({},a),{},{attendance:[],leave_requests:[]})}}));n(t)}}catch(e){console.error("Chyba pri na\u010d\xedtan\xed d\xe1t:",e)}finally{u(!1)}},C=e=>{var a,t,s;const r=(e=>{const a=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(a,"-").concat(t,"-").concat(s)})(new Date);if("terminated"===e.status)return{status:"terminated",label:"Ukon\u010den\xfd",color:"red",icon:A.A};if("inactive"===e.status)return{status:"inactive",label:"Neakt\xedvny",color:"gray",icon:A.A};if("on_leave"===e.status)return{status:"on_leave",label:"Na dovolenke",color:"blue",icon:v.A};const i=null===(a=e.attendance)||void 0===a?void 0:a.find(e=>e.date===r);if(i){if("present"===i.status)return{status:"working",label:"Pracuje",color:"green",icon:d.A};if("late"===i.status)return{status:"late",label:"Me\u0161k\xe1",color:"yellow",icon:z.A};if("absent"===i.status)return{status:"absent",label:"Nepr\xedtomn\xfd",color:"red",icon:A.A}}if(null===(t=e.leave_requests)||void 0===t?void 0:t.find(e=>"approved"===e.status&&e.start_date<=r&&e.end_date>=r))return{status:"leave",label:"Dovolenka",color:"blue",icon:v.A};return(null===(s=e.leave_requests)||void 0===s?void 0:s.find(e=>"approved"===e.status&&"sick_leave"===e.leave_type&&e.start_date<=r&&e.end_date>=r))?{status:"sick",label:"Choroba",color:"red",icon:A.A}:"active"===e.status?{status:"unknown",label:"Nepr\xedtomn\xfd",color:"gray",icon:A.A}:{status:"unknown",label:"Nezn\xe1my stav",color:"gray",icon:A.A}},S=e=>{switch(e){case"green":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"yellow":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"red":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"blue":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},V=i.filter(e=>e.first_name.toLowerCase().includes(g.toLowerCase())||e.last_name.toLowerCase().includes(g.toLowerCase())||e.email.toLowerCase().includes(g.toLowerCase())||e.position.toLowerCase().includes(g.toLowerCase())),L=i.filter(e=>"working"===C(e).status).length,O=i.filter(e=>"working"!==C(e).status).length;return h?(0,p.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,p.jsx)(P.A,{size:"lg",text:"Na\u010d\xedtavam zamestnancov..."})}):(0,p.jsxs)("div",{className:"space-y-6",children:[(0,p.jsx)("div",{className:"flex items-center justify-between",children:(0,p.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,p.jsxs)("button",{onClick:t,className:"flex items-center text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:[(0,p.jsx)(f.A,{className:"h-5 w-5 mr-2"}),"Sp\xe4\u0165 na Dashboard"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Zamestnanci"}),(0,p.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Preh\u013ead zamestnancov a ich aktu\xe1lnych stavov"})]})]})}),(0,p.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,p.jsx)("div",{className:"bg-white dark:bg-dark-800 rounded-lg shadow p-6 border-l-4 border-green-500",children:(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"p-2 bg-green-100 dark:bg-green-900 rounded-lg",children:(0,p.jsx)(d.A,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),(0,p.jsxs)("div",{className:"ml-4",children:[(0,p.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Pracuj\xfa"}),(0,p.jsx)("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:L})]})]})}),(0,p.jsx)("div",{className:"bg-white dark:bg-dark-800 rounded-lg shadow p-6 border-l-4 border-red-500",children:(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"p-2 bg-red-100 dark:bg-red-900 rounded-lg",children:(0,p.jsx)(A.A,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),(0,p.jsxs)("div",{className:"ml-4",children:[(0,p.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Nepracuj\xfa"}),(0,p.jsx)("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:O})]})]})}),(0,p.jsx)("div",{className:"bg-white dark:bg-dark-800 rounded-lg shadow p-6 border-l-4 border-blue-500",children:(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:(0,p.jsx)(o.A,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),(0,p.jsxs)("div",{className:"ml-4",children:[(0,p.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Celkovo"}),(0,p.jsx)("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:i.length})]})]})})]}),(0,p.jsx)("div",{className:"bg-white dark:bg-dark-800 rounded-lg shadow p-6",children:(0,p.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Firma"}),(0,p.jsx)("select",{value:(null===m||void 0===m?void 0:m.id)||"",onChange:e=>(async e=>{try{const a=l.find(a=>a.id===e);x(a);const t=await D.hrService.getEmployees(e),r=await Promise.all(t.map(async a=>{try{const[t,r]=await Promise.all([D.hrService.getAttendance(e,a.id),D.hrService.getLeaveRequests(e)]);return(0,s.A)((0,s.A)({},a),{},{attendance:t.filter(e=>e.employee_id===a.id),leave_requests:r.filter(e=>e.employee_id===a.id)})}catch(t){return console.error("Chyba pri na\u010d\xedtan\xed detailov pre zamestnanca ".concat(a.id,":"),t),(0,s.A)((0,s.A)({},a),{},{attendance:[],leave_requests:[]})}}));n(r)}catch(a){console.error("Chyba pri na\u010d\xedtan\xed zamestnancov:",a)}})(parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-dark-700 text-gray-900 dark:text-white",children:l.map(e=>(0,p.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Vyh\u013ead\xe1vanie"}),(0,p.jsx)("input",{type:"text",placeholder:"H\u013eada\u0165 zamestnancov...",value:g,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-dark-700 text-gray-900 dark:text-white"})]})]})}),(0,p.jsxs)("div",{className:"bg-white dark:bg-dark-800 rounded-lg shadow overflow-hidden",children:[(0,p.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-dark-600",children:(0,p.jsxs)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Zoznam zamestnancov ",m&&"- ".concat(m.name)]})}),(0,p.jsxs)("div",{className:"overflow-x-auto",children:[(0,p.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-dark-600",children:[(0,p.jsx)("thead",{className:"bg-gray-50 dark:bg-dark-700",children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Zamestnanec"}),(0,p.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Poz\xedcia"}),(0,p.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Kontakt"}),(0,p.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Aktu\xe1lny stav"}),(0,p.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"D\xe1tum n\xe1stupu"}),(0,p.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Akcie"})]})}),(0,p.jsx)("tbody",{className:"bg-white dark:bg-dark-800 divide-y divide-gray-200 dark:divide-dark-600",children:V.map(e=>{const a=C(e),t=a.icon;return(0,p.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-dark-700",children:[(0,p.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,p.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 dark:bg-dark-600 flex items-center justify-center",children:(0,p.jsx)(o.A,{className:"h-6 w-6 text-gray-600 dark:text-gray-400"})})}),(0,p.jsxs)("div",{className:"ml-4",children:[(0,p.jsxs)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[e.first_name," ",e.last_name]}),(0,p.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.employee_id})]})]})}),(0,p.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,p.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:e.position}),(0,p.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.department})]}),(0,p.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,p.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:e.email}),e.phone&&(0,p.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.phone})]}),(0,p.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)(t,{className:"h-4 w-4 mr-2 ".concat("green"===a.color?"text-green-600 dark:text-green-400":"yellow"===a.color?"text-yellow-600 dark:text-yellow-400":"red"===a.color?"text-red-600 dark:text-red-400":"blue"===a.color?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400")}),(0,p.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(S(a.color)),children:a.label})]})}),(0,p.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:new Date(e.hire_date).toLocaleDateString("sk-SK")}),(0,p.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:(0,p.jsxs)("button",{onClick:()=>{k(e),j(!0)},className:"inline-flex items-center px-3 py-1 border border-gray-300 dark:border-dark-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-dark-700 hover:bg-gray-50 dark:hover:bg-dark-600 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,p.jsx)(E.A,{className:"h-4 w-4 mr-1"}),"Upravi\u0165"]})})]},e.id)})})]}),0===V.length&&(0,p.jsxs)("div",{className:"text-center py-8",children:[(0,p.jsx)(o.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,p.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:g?"\u017diadni zamestnanci nen\xe1jden\xed":"\u017diadni zamestnanci"}),(0,p.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:g?"Sk\xfaste zmeni\u0165 vyh\u013ead\xe1vac\xed v\xfdraz":"V tejto firme nie s\xfa \u017eiadni zamestnanci"})]})]})]}),(0,p.jsx)(U.A,{isOpen:b,onClose:()=>{j(!1),k(null)},onSave:async e=>{if(w)try{await D.hrService.updateEmployee(w.id,e),await _(),j(!1),k(null)}catch(a){console.error("Chyba pri aktualiz\xe1cii zamestnanca:",a),alert("Chyba pri aktualiz\xe1cii zamestnanca")}},employee:w})]})},L=e=>{const a=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(a,"-").concat(t,"-").concat(s)},O=e=>{let{userEmail:a="user@portal.sk"}=e;const[t,u]=(0,r.useState)({name:"Pou\u017e\xedvate\u013e",email:a,phone:"+421 123 456 789",bio:"Akt\xedvny pou\u017e\xedvate\u013e port\xe1lu s z\xe1ujmom o dokumenty a \xfalohy."}),[f,v]=(0,r.useState)(!1),[j,k]=(0,r.useState)(!1),[_,C]=(0,r.useState)(null),[A,z]=(0,r.useState)(!1),[E,P]=(0,r.useState)(null),[U,O]=(0,r.useState)([]),[F,I]=(0,r.useState)(!0),[T,Z]=(0,r.useState)(0),[M,B]=(0,r.useState)([]),[q,K]=(0,r.useState)(!0),[R,$]=(0,r.useState)(!1),[H,W]=(0,r.useState)(!1),[Y,G]=(0,r.useState)(!1),[J,Q]=(0,r.useState)({working:0,notWorking:0,total:0}),X=(0,r.useCallback)(async()=>{try{const e=await N.apiService.getUnreadCount(a);Z(e)}catch(e){console.error("Chyba pri na\u010d\xedtan\xed po\u010dtu nepre\u010d\xedtan\xfdch spr\xe1v:",e)}},[a]),ee=(0,r.useCallback)(async()=>{try{const t=await N.apiService.getUserCompanies(a);let s=0,r=0,i=0;for(const a of t)try{const t=await D.hrService.getEmployees(a.id);i+=t.length;const n=L(new Date);for(const i of t)try{const[e,t]=await Promise.all([D.hrService.getAttendance(a.id,i.id),D.hrService.getLeaveRequests(a.id)]),l=e.filter(e=>e.employee_id===i.id),d=t.filter(e=>e.employee_id===i.id);if("terminated"===i.status||"inactive"===i.status)r++;else if("on_leave"===i.status)r++;else{const e=l.find(e=>e.date===n);if(e&&"present"===e.status)s++;else{d.find(e=>"approved"===e.status&&e.start_date<=n&&e.end_date>=n)||r++}}}catch(e){console.error("Chyba pri na\u010d\xedtan\xed detailov pre zamestnanca ".concat(i.id,":"),e),r++}}catch(e){console.error("Chyba pri na\u010d\xedtan\xed zamestnancov pre firmu ".concat(a.id,":"),e)}Q({working:s,notWorking:r,total:i})}catch(e){console.error("Chyba pri na\u010d\xedtan\xed po\u010dtu zamestnancov:",e)}},[a]);(0,r.useEffect)(()=>{X(),ee()},[X,ee]),(0,r.useEffect)(()=>{(async()=>{try{K(!0);const e=(await N.apiService.getUserTasks(a)).map(e=>({id:e.id.toString(),title:e.title,description:e.description||"",status:e.status,priority:e.priority,assignedTo:e.assigned_to,dueDate:e.due_date||"",createdAt:e.created_at,createdBy:e.created_by,category:"other"}));B(e)}catch(e){console.error("Chyba pri na\u010d\xedtan\xed \xfaloh:",e)}finally{K(!1)}})()},[a]),(0,r.useEffect)(()=>{(async()=>{try{I(!0);const e=await N.apiService.getUserCompanies(a);O(e)}catch(e){console.error("Chyba pri na\u010d\xedtan\xed firiem:",e)}finally{I(!1)}})()},[a]);const ae=()=>{C(null),z(!1),k(!0)},te=()=>{P(null)};return E?(0,p.jsx)(b.default,{company:E,onClose:te,userEmail:a,userRole:"company"}):R?(0,p.jsx)(w,{userEmail:a,onBack:()=>$(!1)}):H?(0,p.jsx)(S,{userEmail:a,onBack:()=>W(!1)}):Y?(0,p.jsx)(V,{userEmail:a,onBack:()=>G(!1)}):(0,p.jsxs)("div",{className:"space-y-6",children:[(0,p.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"V\xe1\u0161 Dashboard"}),(0,p.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Vyberte si firmu pre pr\xe1cu"}),(0,p.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Prihl\xe1sen\xfd ako: ",t.name," (",a,")"]})]}),(0,p.jsx)("div",{className:"mt-4 sm:mt-0 flex items-center space-x-4",children:(0,p.jsx)("button",{onClick:()=>v(!0),className:"text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 text-sm font-medium",children:"Upravi\u0165 profil"})})]}),(0,p.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[(0,p.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"flex-shrink-0",children:(0,p.jsx)(i.A,{className:"h-8 w-8 text-blue-500"})}),(0,p.jsxs)("div",{className:"ml-4",children:[(0,p.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Va\u0161e firmy"}),(0,p.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:U.length})]})]})}),(0,p.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>G(!0),children:(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"flex-shrink-0",children:(0,p.jsx)(n.A,{className:"h-8 w-8 text-green-500"})}),(0,p.jsxs)("div",{className:"ml-4",children:[(0,p.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Zamestnanci"}),(0,p.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,p.jsx)("p",{className:"text-2xl font-bold text-green-600",children:J.working}),(0,p.jsx)("span",{className:"text-sm text-gray-500",children:"/"}),(0,p.jsx)("p",{className:"text-2xl font-bold text-red-600",children:J.notWorking})]}),(0,p.jsxs)("p",{className:"text-sm text-gray-500",children:[J.total," celkovo"]})]})]})}),(0,p.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>W(!0),children:(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"flex-shrink-0",children:(0,p.jsx)(l.A,{className:"h-8 w-8 text-purple-500"})}),(0,p.jsxs)("div",{className:"ml-4",children:[(0,p.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Nepre\u010d\xedtan\xe9 spr\xe1vy"}),(0,p.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:T})]})]})}),(0,p.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"flex-shrink-0",children:(0,p.jsx)(d.A,{className:"h-8 w-8 text-green-500"})}),(0,p.jsxs)("div",{className:"ml-4",children:[(0,p.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Akt\xedvne firmy"}),(0,p.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:U.filter(e=>"active"===e.status).length})]})]})}),(0,p.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>$(!0),children:(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"flex-shrink-0",children:(0,p.jsx)(c.A,{className:"h-8 w-8 text-orange-500"})}),(0,p.jsxs)("div",{className:"ml-4",children:[(0,p.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Va\u0161e \xfalohy"}),(0,p.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.length}),(0,p.jsxs)("p",{className:"text-sm text-gray-500",children:[M.filter(e=>"pending"===e.status).length," \u010dakaj\xfacich"]})]})]})})]}),(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,p.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,p.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Va\u0161e firmy"}),(0,p.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Vyberte firmu, s ktorou chcete pracova\u0165"})]}),(0,p.jsxs)("div",{className:"p-6",children:[F?(0,p.jsxs)("div",{className:"text-center py-12",children:[(0,p.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,p.jsx)("p",{className:"mt-4 text-gray-600",children:"Na\u010d\xedtavam va\u0161e firmy..."})]}):U.length>0?(0,p.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:U.map(e=>(0,p.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 hover:shadow-md transition-all duration-200 cursor-pointer border-2 border-transparent hover:border-primary-300",onClick:()=>(e=>{P(e)})(e),children:[(0,p.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,p.jsxs)("div",{className:"flex-1",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.name}),(0,p.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)(i.A,{className:"h-4 w-4 mr-2"}),(0,p.jsxs)("span",{children:["I\u010cO: ",e.ico]})]}),(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)(l.A,{className:"h-4 w-4 mr-2"}),(0,p.jsx)("span",{children:e.email||e.owner_email})]}),e.address&&(0,p.jsxs)("div",{className:"flex items-start",children:[(0,p.jsx)(o.A,{className:"h-4 w-4 mr-2 mt-0.5"}),(0,p.jsx)("span",{className:"text-xs",children:e.address})]})]})]}),(0,p.jsx)("div",{className:"flex flex-col items-end space-y-2",children:(0,p.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat("active"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"active"===e.status?"Akt\xedvna":"Neakt\xedvna"})})]}),(0,p.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[(0,p.jsx)("div",{className:"flex space-x-2",children:(0,p.jsx)("button",{onClick:a=>{a.stopPropagation(),(e=>{C(e),z(!0),k(!0)})(e)},className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Upravi\u0165"})}),(0,p.jsxs)("div",{className:"flex items-center text-primary-600",children:[(0,p.jsx)("span",{className:"text-sm font-medium mr-1",children:"Vybra\u0165 firmu"}),(0,p.jsx)(m.A,{className:"h-4 w-4"})]})]})]},e.id))}):(0,p.jsxs)("div",{className:"text-center py-12",children:[(0,p.jsx)(i.A,{className:"mx-auto h-16 w-16 text-gray-400"}),(0,p.jsx)("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"Nem\xe1te \u017eiadne firmy"}),(0,p.jsx)("p",{className:"mt-2 text-sm text-gray-500 mb-6",children:"Pre pr\xe1cu v port\xe1li potrebujete vytvori\u0165 aspo\u0148 jednu firmu."}),(0,p.jsxs)("button",{onClick:ae,className:"bg-primary-600 text-white px-6 py-3 rounded-md hover:bg-primary-700 flex items-center mx-auto",children:[(0,p.jsx)(x.A,{className:"h-5 w-5 mr-2"}),"Prida\u0165 prv\xfa firmu"]})]}),U.length>0&&(0,p.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,p.jsxs)("button",{onClick:ae,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 flex items-center",children:[(0,p.jsx)(x.A,{className:"h-5 w-5 mr-2"}),"Prida\u0165 \u010fal\u0161iu firmu"]})})]})]}),(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,p.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,p.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"V\xe1\u0161 profil"})}),(0,p.jsx)("div",{className:"p-6",children:(0,p.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,p.jsx)("div",{className:"flex-shrink-0",children:(0,p.jsx)("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center",children:(0,p.jsx)(h.A,{className:"h-8 w-8 text-primary-600"})})}),(0,p.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,p.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:t.name}),(0,p.jsx)("p",{className:"text-sm text-gray-500",children:t.email}),t.phone&&(0,p.jsx)("p",{className:"text-sm text-gray-500",children:t.phone}),t.bio&&(0,p.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:t.bio})]}),(0,p.jsx)("button",{onClick:()=>v(!0),className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"Upravi\u0165"})]})})]}),(0,p.jsx)(g,{isOpen:f,onClose:()=>v(!1),onSave:e=>{u(e),console.log("Profil bol aktualizovan\xfd:",e)},currentProfile:t}),(0,p.jsx)(y,{isOpen:j,onClose:()=>k(!1),onSave:async e=>{try{if(A)await N.apiService.updateCompany(e.id,e),O(a=>a.map(a=>a.id===e.id?e:a));else{const t=(0,s.A)((0,s.A)({},e),{},{owner_email:a,status:"active"});if(!t.name||!t.ico||!t.address||!t.authorized_person)return void alert("Ch\xfdbaj\xfa povinn\xe9 \xfadaje: n\xe1zov firmy, I\u010cO, adresa alebo opr\xe1vnen\xe1 osoba");console.log("Vytv\xe1ram firmu s d\xe1tami:",t);const r=await N.apiService.createCompany(t);console.log("Odpove\u010f z API:",r);const i=(0,s.A)((0,s.A)({},e),{},{id:r.companyId,owner_email:a,status:"active"});O(e=>[...e,i]),k(!1),C(null),z(!1)}}catch(t){console.error("Chyba pri ukladan\xed firmy:",t),alert("Chyba pri ukladan\xed firmy: "+(t instanceof Error?t.message:"Nezn\xe1ma chyba"))}},currentCompany:_,isEditing:A})]})}}}]);