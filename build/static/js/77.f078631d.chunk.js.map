{"version":3,"file":"static/js/77.f078631d.chunk.js","mappings":"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","sources":["components/IssuedInvoicesPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { \r\n  EyeIcon, \r\n  PencilIcon, \r\n  TrashIcon, \r\n  PlusIcon,\r\n  ArrowPathIcon,\r\n  MagnifyingGlassIcon,\r\n  FunnelIcon,\r\n  ArrowLeftIcon\r\n} from '@heroicons/react/24/outline';\r\nimport { accountingService, IssuedInvoice } from '../services/accountingService';\r\nimport InvoiceSummary from './InvoiceSummary';\r\nimport { useLocalStorage } from '../hooks/useLocalStorage';\r\n\r\nconst IssuedInvoicesPage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { companyId: urlCompanyId } = useParams<{ companyId: string }>();\r\n  const [companies, setCompanies] = useState<any[]>([]);\r\n  \r\n  // Používame useLocalStorage hook pre konzistentnosť s App.tsx\r\n  const [userEmail] = useLocalStorage('userEmail', '');\r\n  const [userRole] = useLocalStorage<'admin' | 'accountant' | 'user' | 'employee' | null>('userRole', null);\r\n  const [companyId, setCompanyId] = useLocalStorage<number | null>('selectedCompanyId', null);\r\n  \r\n  const [invoices, setInvoices] = useState<IssuedInvoice[]>([]);\r\n  const [selectedInvoice, setSelectedInvoice] = useState<IssuedInvoice | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  \r\n  // Filtre\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [filters, setFilters] = useState({\r\n    customerName: '',\r\n    dueDateFrom: '',\r\n    dueDateTo: '',\r\n    unpaidAmountMin: '',\r\n    unpaidAmountMax: '',\r\n    invoiceNumber: ''\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (userRole && userEmail) {\r\n      loadCompanies();\r\n    }\r\n  }, [userRole, userEmail]);\r\n\r\n  useEffect(() => {\r\n    if (urlCompanyId && !companyId) {\r\n      setCompanyId(Number(urlCompanyId));\r\n    }\r\n  }, [urlCompanyId, companyId]);\r\n\r\n  useEffect(() => {\r\n    if (companyId) {\r\n      loadInvoices();\r\n      // Automatické obnovenie faktúr z MDB pri načítaní stránky\r\n      handleRefreshInvoices();\r\n    }\r\n  }, [companyId]);\r\n\r\n  const loadCompanies = async () => {\r\n    try {\r\n      let endpoint = '/api/companies';\r\n      \r\n      // Výber správneho endpointu podľa role\r\n      if (userRole === 'user') {\r\n        endpoint = `/api/companies/user/${userEmail}`;\r\n      } else if (userRole === 'accountant') {\r\n        endpoint = `/api/companies/accountant/${userEmail}`;\r\n      }\r\n      // Pre admin sa používa default endpoint '/api/companies'\r\n      \r\n      const response = await fetch(endpoint);\r\n      const companiesData = await response.json();\r\n      setCompanies(companiesData);\r\n      \r\n      // Automaticky nastavíme firmu podľa role, len ak nemáme companyId z URL ani localStorage\r\n      if (companiesData.length > 0 && !urlCompanyId && !companyId) {\r\n        setCompanyId(companiesData[0].id);\r\n      }\r\n    } catch (error) {\r\n      console.error('Chyba pri načítaní firiem:', error);\r\n    }\r\n  };\r\n\r\n  const loadInvoices = async () => {\r\n    if (!companyId) return;\r\n    \r\n    try {\r\n      setLoading(true);\r\n      const data = await accountingService.getIssuedInvoices(companyId, { limit: 100 });\r\n      setInvoices(data);\r\n      if (data.length > 0) {\r\n        setSelectedInvoice(data[0]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Chyba pri načítaní faktúr:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const formatDate = (dateString: string | null | undefined) => {\r\n    if (!dateString || dateString === '') return '-';\r\n    try {\r\n      const date = new Date(dateString);\r\n      if (isNaN(date.getTime())) return '-';\r\n      return date.toLocaleDateString('sk-SK');\r\n    } catch (error) {\r\n      return '-';\r\n    }\r\n  };\r\n\r\n  const formatCurrency = (amount: number | null | undefined) => {\r\n    if (amount === null || amount === undefined || isNaN(amount)) return '-';\r\n    return new Intl.NumberFormat('sk-SK', {\r\n      style: 'currency',\r\n      currency: 'EUR'\r\n    }).format(amount);\r\n  };\r\n\r\n  const filteredInvoices = invoices.filter(invoice => {\r\n    // Základný search\r\n    const matchesSearch = \r\n      invoice.invoice_number?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      invoice.customer_name?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      (invoice as any).varsym?.toLowerCase().includes(searchTerm.toLowerCase());\r\n    \r\n    if (!matchesSearch) return false;\r\n    \r\n    // Filtre\r\n    if (filters.customerName && !invoice.customer_name?.toLowerCase().includes(filters.customerName.toLowerCase())) {\r\n      return false;\r\n    }\r\n    \r\n    if (filters.invoiceNumber && !invoice.invoice_number?.toLowerCase().includes(filters.invoiceNumber.toLowerCase())) {\r\n      return false;\r\n    }\r\n    \r\n    // Filtre dátumov\r\n    if (filters.dueDateFrom) {\r\n      const dueDate = new Date(invoice.due_date);\r\n      const fromDate = new Date(filters.dueDateFrom);\r\n      if (dueDate < fromDate) return false;\r\n    }\r\n    \r\n    if (filters.dueDateTo) {\r\n      const dueDate = new Date(invoice.due_date);\r\n      const toDate = new Date(filters.dueDateTo);\r\n      if (dueDate > toDate) return false;\r\n    }\r\n    \r\n    // Filtre nezaplatených súm\r\n    const unpaidAmount = parseFloat(String(invoice.kc_likv || 0)) || 0;\r\n    \r\n    if (filters.unpaidAmountMin) {\r\n      const minAmount = parseFloat(filters.unpaidAmountMin);\r\n      if (unpaidAmount < minAmount) return false;\r\n    }\r\n    \r\n    if (filters.unpaidAmountMax) {\r\n      const maxAmount = parseFloat(filters.unpaidAmountMax);\r\n      if (unpaidAmount > maxAmount) return false;\r\n    }\r\n    \r\n    return true;\r\n  });\r\n\r\n  const handleInvoiceSelect = (invoice: IssuedInvoice) => {\r\n    setSelectedInvoice(invoice);\r\n  };\r\n\r\n  const handleViewInvoiceDetail = (invoice: IssuedInvoice) => {\r\n    window.location.href = `/invoice/issued/${invoice.id}`;\r\n  };\r\n\r\n  const handleEditInvoice = (invoice: IssuedInvoice) => {\r\n    console.log('Editovať faktúru:', invoice);\r\n    alert('Editovať faktúru');\r\n  };\r\n\r\n  const handleFilterChange = (field: string, value: string) => {\r\n    setFilters(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const clearFilters = () => {\r\n    setFilters({\r\n      customerName: '',\r\n      dueDateFrom: '',\r\n      dueDateTo: '',\r\n      unpaidAmountMin: '',\r\n      unpaidAmountMax: '',\r\n      invoiceNumber: ''\r\n    });\r\n  };\r\n\r\n  const handleDeleteInvoice = async (invoice: IssuedInvoice) => {\r\n    if (!window.confirm(`Naozaj chcete vymazať faktúru ${invoice.invoice_number}?`)) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await accountingService.deleteIssuedInvoice(invoice.id!);\r\n      await loadInvoices();\r\n    } catch (error) {\r\n      console.error('Chyba pri mazaní faktúry:', error);\r\n      alert('Chyba pri mazaní faktúry');\r\n    }\r\n  };\r\n\r\n  const handleCreateInvoice = () => {\r\n    console.log('Vytvoriť novú faktúru');\r\n    alert('Vytvoriť novú faktúru');\r\n  };\r\n\r\n  const handleRefreshInvoices = async () => {\r\n    if (!companyId) return;\r\n    \r\n    try {\r\n      await accountingService.refreshInvoicesFromMdb(companyId);\r\n      await loadInvoices();\r\n    } catch (error) {\r\n      console.error('Chyba pri obnovení faktúr:', error);\r\n      alert('Chyba pri obnovení faktúr');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-dark-900\">\r\n      {/* Header */}\r\n      <div className=\"bg-white dark:bg-dark-800 shadow-sm border-b border-gray-200 dark:border-gray-700\">\r\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n          <div className=\"flex items-center justify-between h-16\">\r\n            <div className=\"flex items-center\">\r\n              <button\r\n                onClick={() => navigate('/accounting')}\r\n                className=\"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n              >\r\n                <ArrowLeftIcon className=\"h-4 w-4 mr-2\" />\r\n                Späť na Účtovníctvo\r\n              </button>\r\n            </div>\r\n                         <div className=\"flex items-center space-x-4\">\r\n               <h1 className=\"text-xl font-semibold text-gray-900 dark:text-white\">Vydané faktúry</h1>\r\n               \r\n               {/* Zobrazenie aktuálnej firmy */}\r\n               {companies.length > 0 && companyId && (\r\n                 <div className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                   Firma: {companies.find(c => c.id === companyId)?.name} (IČO: {companies.find(c => c.id === companyId)?.ico})\r\n                 </div>\r\n               )}\r\n             </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Hlavný obsah */}\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\r\n        <div className=\"flex flex-col\" style={{ height: 'calc(100vh - 200px)' }}>\r\n          {/* Horná časť - Sumár faktúr */}\r\n          <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-blue-200\" style={{ height: '200px', overflow: 'hidden' }}>\r\n            <div className=\"p-4\">\r\n              <InvoiceSummary invoices={filteredInvoices} type=\"issued\" />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Spodná časť - Zoznam faktúr */}\r\n          <div className=\"bg-white overflow-hidden flex flex-col\" style={{ height: 'calc(100vh - 400px)', maxHeight: '700px' }}>\r\n            {/* Hlavička zoznamu */}\r\n            <div className=\"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-100 flex-shrink-0\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center space-x-4\">\r\n                  <h2 className=\"text-lg font-semibold text-gray-900\">Zoznam vydaných faktúr</h2>\r\n                  \r\n                  {/* Tlačidlo filtrov */}\r\n                  <button\r\n                    onClick={() => setShowFilters(!showFilters)}\r\n                    className={`inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md ${\r\n                      showFilters \r\n                        ? 'text-white bg-blue-600 hover:bg-blue-700' \r\n                        : 'text-gray-700 bg-white hover:bg-gray-50'\r\n                    } focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`}\r\n                  >\r\n                    <FunnelIcon className=\"h-4 w-4 mr-2\" />\r\n                    Filtre\r\n                  </button>\r\n                </div>\r\n                <div className=\"flex items-center space-x-4\">\r\n                  <div className=\"relative\">\r\n                    <MagnifyingGlassIcon className=\"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Hľadať faktúry...\"\r\n                      value={searchTerm}\r\n                      onChange={(e) => setSearchTerm(e.target.value)}\r\n                      className=\"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <button\r\n                      onClick={handleRefreshInvoices}\r\n                      className=\"inline-flex items-center px-3 py-2 border border-blue-300 shadow-sm text-sm leading-4 font-medium rounded-md text-blue-700 bg-white hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                    >\r\n                      <ArrowPathIcon className=\"h-4 w-4 mr-1\" />\r\n                      Obnoviť\r\n                    </button>\r\n                    <button\r\n                      onClick={handleCreateInvoice}\r\n                      className=\"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                    >\r\n                      <PlusIcon className=\"h-4 w-4 mr-1\" />\r\n                      Nová faktúra\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Panel filtrov */}\r\n            {showFilters && (\r\n              <div className=\"px-6 py-4 border-b border-gray-200 bg-gray-50\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                  {/* Firma */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Firma</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={filters.customerName}\r\n                      onChange={(e) => handleFilterChange('customerName', e.target.value)}\r\n                      placeholder=\"Zadajte názov firmy...\"\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Číslo faktúry */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Číslo faktúry</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={filters.invoiceNumber}\r\n                      onChange={(e) => handleFilterChange('invoiceNumber', e.target.value)}\r\n                      placeholder=\"Zadajte číslo faktúry...\"\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Dátum splatnosti od */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Splatné od</label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={filters.dueDateFrom}\r\n                      onChange={(e) => handleFilterChange('dueDateFrom', e.target.value)}\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Dátum splatnosti do */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Splatné do</label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={filters.dueDateTo}\r\n                      onChange={(e) => handleFilterChange('dueDateTo', e.target.value)}\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Doplatok od */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Doplatok od (€)</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      step=\"0.01\"\r\n                      value={filters.unpaidAmountMin}\r\n                      onChange={(e) => handleFilterChange('unpaidAmountMin', e.target.value)}\r\n                      placeholder=\"0.00\"\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Doplatok do */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Doplatok do (€)</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      step=\"0.01\"\r\n                      value={filters.unpaidAmountMax}\r\n                      onChange={(e) => handleFilterChange('unpaidAmountMax', e.target.value)}\r\n                      placeholder=\"999999.99\"\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Tlačidlá filtrov */}\r\n                <div className=\"flex items-center justify-end mt-4 space-x-3\">\r\n                  <button\r\n                    onClick={clearFilters}\r\n                    className=\"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                  >\r\n                    Vymazať filtre\r\n                  </button>\r\n                  <div className=\"text-sm text-gray-500\">\r\n                    Zobrazených: {filteredInvoices.length} z {invoices.length}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Tabuľka faktúr */}\r\n            <div className=\"overflow-x-auto overflow-y-auto\" style={{ height: 'calc(100vh - 500px)', maxHeight: '600px' }}>\r\n              <table className=\"min-w-full divide-y divide-gray-200\">\r\n                <thead className=\"bg-gray-50\">\r\n                  <tr>\r\n                    <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Číslo\r\n                    </th>\r\n                    <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Varsym\r\n                    </th>\r\n                    <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Dátum\r\n                    </th>\r\n                    <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Splatné\r\n                    </th>\r\n                    <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Odberateľ\r\n                    </th>\r\n                    <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Celkom\r\n                    </th>\r\n                    <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Doplatok\r\n                    </th>\r\n                    <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Akcie\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                  {loading ? (\r\n                    <tr>\r\n                      <td colSpan={8} className=\"px-6 py-4 text-center text-gray-500\">\r\n                        Načítavam faktúry...\r\n                      </td>\r\n                    </tr>\r\n                  ) : filteredInvoices.length === 0 ? (\r\n                    <tr>\r\n                      <td colSpan={8} className=\"px-6 py-4 text-center text-gray-500\">\r\n                        Žiadne faktúry neboli nájdené\r\n                      </td>\r\n                    </tr>\r\n                  ) : (\r\n                    filteredInvoices.map((invoice) => (\r\n                      <tr\r\n                        key={invoice.id}\r\n                        onClick={() => handleInvoiceSelect(invoice)}\r\n                        className={`cursor-pointer hover:bg-gray-50 ${\r\n                          selectedInvoice?.id === invoice.id ? 'bg-blue-50' : ''\r\n                        }`}\r\n                      >\r\n                        <td className=\"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900\">\r\n                          {invoice.invoice_number}\r\n                        </td>\r\n                        <td className=\"px-6 py-2 whitespace-nowrap text-sm text-gray-500\">\r\n                          {(invoice as any).varsym || '-'}\r\n                        </td>\r\n                        <td className=\"px-6 py-2 whitespace-nowrap text-sm text-gray-500\">\r\n                          {formatDate(invoice.issue_date)}\r\n                        </td>\r\n                        <td className=\"px-6 py-2 whitespace-nowrap text-sm text-gray-500\">\r\n                          {formatDate(invoice.due_date)}\r\n                        </td>\r\n                        <td className=\"px-6 py-2 whitespace-nowrap text-sm text-gray-900\">\r\n                          {invoice.customer_name}\r\n                        </td>\r\n                        <td className=\"px-6 py-2 whitespace-nowrap text-sm text-gray-900\">\r\n                          {formatCurrency(invoice.kc_celkem || invoice.total_amount)}\r\n                        </td>\r\n                        <td className=\"px-6 py-2 whitespace-nowrap text-sm text-gray-900\">\r\n                          {formatCurrency(invoice.kc_likv || 0)}\r\n                        </td>\r\n                        <td className=\"px-6 py-2 whitespace-nowrap text-sm text-gray-500\">\r\n                          <div className=\"flex items-center space-x-2\">\r\n                            <button\r\n                              onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                handleViewInvoiceDetail(invoice);\r\n                              }}\r\n                              className=\"text-blue-600 hover:text-blue-900\"\r\n                              title=\"Zobraziť detail\"\r\n                            >\r\n                              <EyeIcon className=\"h-4 w-4\" />\r\n                            </button>\r\n                            <button\r\n                              onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                handleEditInvoice(invoice);\r\n                              }}\r\n                              className=\"text-blue-600 hover:text-blue-900\"\r\n                              title=\"Upraviť\"\r\n                            >\r\n                              <PencilIcon className=\"h-4 w-4\" />\r\n                            </button>\r\n                            <button\r\n                              onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                handleDeleteInvoice(invoice);\r\n                              }}\r\n                              className=\"text-red-600 hover:text-red-900\"\r\n                              title=\"Vymazať\"\r\n                            >\r\n                              <TrashIcon className=\"h-4 w-4\" />\r\n                            </button>\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                    ))\r\n                  )}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default IssuedInvoicesPage;\r\n"],"names":["IssuedInvoicesPage","_companies$find","_companies$find2","navigate","useNavigate","companyId","urlCompanyId","useParams","companies","setCompanies","useState","userEmail","useLocalStorage","userRole","setCompanyId","invoices","setInvoices","selectedInvoice","setSelectedInvoice","loading","setLoading","searchTerm","setSearchTerm","showFilters","setShowFilters","filters","setFilters","customerName","dueDateFrom","dueDateTo","unpaidAmountMin","unpaidAmountMax","invoiceNumber","useEffect","loadCompanies","Number","loadInvoices","handleRefreshInvoices","async","endpoint","concat","response","fetch","companiesData","json","length","id","error","console","data","accountingService","getIssuedInvoices","limit","formatDate","dateString","date","Date","isNaN","getTime","toLocaleDateString","formatCurrency","amount","undefined","Intl","NumberFormat","style","currency","format","filteredInvoices","filter","invoice","_invoice$invoice_numb","_invoice$customer_nam","_varsym","_invoice$customer_nam2","_invoice$invoice_numb2","invoice_number","toLowerCase","includes","customer_name","varsym","due_date","unpaidAmount","parseFloat","String","kc_likv","handleFilterChange","field","value","prev","_objectSpread","refreshInvoicesFromMdb","alert","_jsxs","className","children","_jsx","onClick","ArrowLeftIcon","find","c","name","ico","height","overflow","InvoiceSummary","type","maxHeight","FunnelIcon","MagnifyingGlassIcon","placeholder","onChange","e","target","ArrowPathIcon","handleCreateInvoice","log","PlusIcon","step","clearFilters","colSpan","map","handleInvoiceSelect","issue_date","kc_celkem","total_amount","stopPropagation","window","location","href","handleViewInvoiceDetail","title","EyeIcon","handleEditInvoice","PencilIcon","confirm","deleteIssuedInvoice","handleDeleteInvoice","TrashIcon"],"sourceRoot":""}